[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.15.9","content-config-digest","5fe3da86cd58b12a","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://jagreehal.github.io\",\"compressHTML\":true,\"base\":\"/ai-sdk-guardrails/\",\"trailingSlash\":\"always\",\"output\":\"static\",\"scopedStyleStrategy\":\"where\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image/\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":false,\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null,null,null],\"rehypePlugins\":[null,[null,{\"experimentalHeadingIdCompat\":false}],null,[null,{\"themes\":[\"github-dark\",\"github-light\"],\"defaultLocale\":\"en\",\"cascadeLayer\":\"starlight.components\",\"styleOverrides\":{\"borderRadius\":\"0px\",\"borderWidth\":\"1px\",\"codePaddingBlock\":\"0.75rem\",\"codePaddingInline\":\"1rem\",\"codeFontFamily\":\"var(--__sl-font-mono)\",\"codeFontSize\":\"var(--sl-text-code)\",\"codeLineHeight\":\"var(--sl-line-height)\",\"uiFontFamily\":\"var(--__sl-font)\",\"textMarkers\":{\"lineDiffIndicatorMarginLeft\":\"0.25rem\",\"defaultChroma\":\"45\",\"backgroundOpacity\":\"60%\"}},\"plugins\":[{\"name\":\"Collapsible sections\",\"styleSettings\":{\"defaultValues\":{\"collapsibleSections\":{\"closedBorderWidth\":\"0\",\"closedPaddingBlock\":\"4px\",\"closedMargin\":\"0\",\"closedFontFamily\":\"inherit\",\"closedFontSize\":\"inherit\",\"closedLineHeight\":\"inherit\",\"openBorderWidth\":\"1px\",\"openPadding\":\"0\",\"openMargin\":\"0\",\"openBackgroundColor\":\"transparent\",\"openBorderColor\":\"transparent\",\"expandIcon\":\"url(\\\"data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%3Cpath%20d%3D'm8.177.677%202.896%202.896a.25.25%200%200%201-.177.427H8.75v1.25a.75.75%200%200%201-1.5%200V4H5.104a.25.25%200%200%201-.177-.427L7.823.677a.25.25%200%200%201%20.354%200ZM7.25%2010.75a.75.75%200%200%201%201.5%200V12h2.146a.25.25%200%200%201%20.177.427l-2.896%202.896a.25.25%200%200%201-.354%200l-2.896-2.896A.25.25%200%200%201%205.104%2012H7.25v-1.25Zm-5-2a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM6%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%206%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM12%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%2012%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5Z'%2F%3E%3C%2Fsvg%3E\\\")\",\"collapseIcon\":\"url(\\\"data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%3Cpath%20d%3D'M10.896%202H8.75V.75a.75.75%200%200%200-1.5%200V2H5.104a.25.25%200%200%200-.177.427l2.896%202.896a.25.25%200%200%200%20.354%200l2.896-2.896A.25.25%200%200%200%2010.896%202ZM8.75%2015.25a.75.75%200%200%201-1.5%200V14H5.104a.25.25%200%200%201-.177-.427l2.896-2.896a.25.25%200%200%201%20.354%200l2.896%202.896a.25.25%200%200%201-.177.427H8.75v1.25Zm-6.5-6.5a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM6%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%206%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM12%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%2012%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5Z'%2F%3E%3C%2Fsvg%3E\\\")\"}},\"cssVarExclusions\":[],\"cssVarReplacements\":[[\"collapsibleSections\",\"cs\"]],\"preventUnitlessValues\":[\"collapsibleSections.closedBorderWidth\",\"collapsibleSections.openBorderWidth\"]},\"hooks\":{}},{\"name\":\"Starlight Plugin\",\"hooks\":{}},{\"name\":\"astro-expressive-code\",\"hooks\":{}}]}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false},\"legacy\":{\"collections\":false},\"prefetch\":{\"prefetchAll\":true},\"i18n\":{\"defaultLocale\":\"en\",\"locales\":[\"en\"],\"routing\":{\"prefixDefaultLocale\":false,\"redirectToDefaultLocale\":false,\"fallbackType\":\"redirect\"}}}","docs",["Map",11,12,42,43,113,114,159,160,205,206,266,267,311,312,352,353,409,410,441,442],"index",{"id":11,"data":13,"body":38,"filePath":39,"digest":40,"legacyId":41,"deferredRender":16},{"title":14,"description":15,"editUrl":16,"head":17,"template":18,"hero":19,"sidebar":35,"pagefind":16,"draft":36},"AI SDK Guardrails","Input and output safety controls for AI SDK applications",true,[],"splash",{"title":14,"tagline":20,"actions":21},"Input and output safety controls for the Vercel AI SDK. Add validation, filtering, and quality checks to your AI applications.",[22,29],{"text":23,"link":24,"variant":25,"icon":26},"Get Started","/quick-start/","primary",{"type":27,"name":28},"icon","right-arrow",{"text":30,"link":31,"variant":32,"icon":33},"View on GitHub","https://github.com/jagreehal/ai-sdk-guardrails","minimal",{"type":27,"name":34},"external",{"hidden":36,"attrs":37},false,{},"import { Card, CardGrid } from '@astrojs/starlight/components';\n\n## Usage\n\n```ts\nimport { withGuardrails, piiDetector } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\nawait generateText({ model, prompt: '...' });\n```\n\n## Features\n\n\u003CCardGrid stagger>\n  \u003CCard title=\"Built-in Guardrails\" icon=\"puzzle\">\n    30+ guardrails for PII detection, prompt injection blocking, toxicity filtering, and content validation.\n  \u003C/Card>\n  \u003CCard title=\"OpenAI Config Compatible\" icon=\"file\">\n    Load configs from guardrails.openai.com directly. Supports snake_case config format with automatic mapping.\n  \u003C/Card>\n  \u003CCard title=\"Auto-Retry\" icon=\"refresh\">\n    Retry when outputs don't meet quality standards. Configurable backoff and retry strategies.\n  \u003C/Card>\n  \u003CCard title=\"Streaming Support\" icon=\"rocket\">\n    Progressive and buffered streaming modes with guardrail checking.\n  \u003C/Card>\n  \u003CCard title=\"Tool Validation\" icon=\"setting\">\n    Validate tool calls, enforce policies, and control tool execution in agent workflows.\n  \u003C/Card>\n  \u003CCard title=\"Custom Guardrails\" icon=\"pencil\">\n    Create domain-specific guardrails with a type-safe API.\n  \u003C/Card>\n\u003C/CardGrid>\n\n## Provider Compatibility\n\nWorks with all AI SDK providers: OpenAI, Anthropic, Google, Mistral, Groq, Ollama, and custom providers.\n\n## Quick Example\n\n```ts\nimport { withGuardrails, piiDetector, sensitiveDataFilter } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\nimport { generateText } from 'ai';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n  outputGuardrails: [sensitiveDataFilter()],\n});\n\nconst { text } = await generateText({\n  model,\n  prompt: 'Analyze this customer request...',\n});\n```\n\n## Use Cases\n\n- **Input validation**: Check for PII, prompt injection, toxic content\n- **Output validation**: Filter sensitive data, enforce quality standards\n- **Compliance**: Block regulated content, maintain audit trails\n- **Tool security**: Validate tool calls, enforce execution policies","src/content/docs/index.mdx","19a6ab087bc1cfc4","index.mdx","installation",{"id":42,"data":44,"body":51,"filePath":52,"digest":53,"rendered":54,"legacyId":112},{"title":45,"description":46,"editUrl":16,"head":47,"template":48,"sidebar":49,"pagefind":16,"draft":36},"Installation","How to install and setup AI SDK Guardrails",[],"doc",{"hidden":36,"attrs":50},{},"## Requirements\n\n- Node.js 18+ or Bun\n- TypeScript 5.0+ (recommended)\n- Vercel AI SDK 4.0+\n\n## Package Installation\n\nInstall via your preferred package manager:\n\n```bash\n# npm\nnpm install ai-sdk-guardrails\n\n# pnpm\npnpm add ai-sdk-guardrails\n\n# yarn\nyarn add ai-sdk-guardrails\n\n# bun\nbun add ai-sdk-guardrails\n```\n\n## Peer Dependencies\n\nAI SDK Guardrails requires the Vercel AI SDK:\n\n```bash\nnpm install ai\n```\n\nYou'll also need at least one AI provider:\n\n```bash\n# OpenAI\nnpm install @ai-sdk/openai\n\n# Anthropic\nnpm install @ai-sdk/anthropic\n\n# Or any other AI SDK provider\n```\n\n## TypeScript Configuration\n\nFor optimal TypeScript support, ensure your `tsconfig.json` includes:\n\n```json\n{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"module\": \"ESNext\",\n    \"moduleResolution\": \"bundler\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true\n  }\n}\n```\n\n## Verify Installation\n\nCreate a simple test file to verify everything is working:\n\n```ts\nimport { withGuardrails, piiDetector } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\nimport { generateText } from 'ai';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\nconst result = await generateText({\n  model,\n  prompt: 'Hello, world!',\n});\n\nconsole.log(result.text);\n```\n\nIf this runs without errors, you're all set!\n\n## Environment Variables\n\nSome guardrails may require API keys. Set these in your `.env` file:\n\n```bash\n# Required for AI SDK\nOPENAI_API_KEY=your-key-here\n\n# Optional: For specific guardrails\n# ANTHROPIC_API_KEY=your-key-here\n```\n\n## Framework-Specific Setup\n\n### Next.js\n\nAI SDK Guardrails works seamlessly with Next.js:\n\n```ts\n// app/api/chat/route.ts\nimport { withGuardrails, piiDetector } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\nimport { streamText } from 'ai';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\nexport async function POST(req: Request) {\n  const { messages } = await req.json();\n\n  const result = await streamText({\n    model,\n    messages,\n  });\n\n  return result.toDataStreamResponse();\n}\n```\n\n### Express\n\n```ts\nimport express from 'express';\nimport { withGuardrails, piiDetector } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\nimport { generateText } from 'ai';\n\nconst app = express();\napp.use(express.json());\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\napp.post('/api/chat', async (req, res) => {\n  const result = await generateText({\n    model,\n    prompt: req.body.prompt,\n  });\n\n  res.json({ text: result.text });\n});\n\napp.listen(3000);\n```\n\n### Hono\n\n```ts\nimport { Hono } from 'hono';\nimport { withGuardrails, piiDetector } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\nimport { generateText } from 'ai';\n\nconst app = new Hono();\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\napp.post('/api/chat', async (c) => {\n  const { prompt } = await c.req.json();\n\n  const result = await generateText({\n    model,\n    prompt,\n  });\n\n  return c.json({ text: result.text });\n});\n\nexport default app;\n```\n\n## Bundle Size\n\nAI SDK Guardrails is designed to be tree-shakeable. Only import the guardrails you actually use:\n\n```ts\n// Good - only imports what you use\nimport { withGuardrails } from 'ai-sdk-guardrails';\nimport { piiDetector } from 'ai-sdk-guardrails/guardrails';\n\n// Avoid - imports everything\nimport * as guardrails from 'ai-sdk-guardrails';\n```\n\nTypical bundle impact:\n- Core (`withGuardrails`): ~2KB gzipped\n- Each guardrail: ~0.5-2KB gzipped\n- Total with 5 guardrails: ~8-12KB gzipped\n\n## Troubleshooting\n\n### \"Cannot find module 'ai-sdk-guardrails'\"\n\nMake sure you've installed both `ai-sdk-guardrails` and `ai`:\n\n```bash\nnpm install ai-sdk-guardrails ai\n```\n\n### TypeScript Errors\n\nEnsure your TypeScript version is 5.0 or higher:\n\n```bash\nnpm install -D typescript@latest\n```\n\n### Build Errors in Next.js\n\nIf you encounter build errors, add to `next.config.js`:\n\n```js\nmodule.exports = {\n  transpilePackages: ['ai-sdk-guardrails'],\n};\n```\n\n## Next Steps\n\n- [Quick Start](/quick-start/) - Build your first guarded AI application\n- [Built-in Guardrails](/guardrails/input/pii/) - Explore available guardrails\n- [API Reference](/api/with-guardrails/) - Detailed API documentation","src/content/docs/installation.md","600876c2e7979ee1",{"html":55,"metadata":56},"\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"requirements\">Requirements\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#requirements\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Requirements”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>Node.js 18+ or Bun\u003C/li>\n\u003Cli>TypeScript 5.0+ (recommended)\u003C/li>\n\u003Cli>Vercel AI SDK 4.0+\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"package-installation\">Package Installation\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#package-installation\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Package Installation”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Install via your preferred package manager:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># npm\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai-sdk-guardrails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># pnpm\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">pnpm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">add\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai-sdk-guardrails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># yarn\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">yarn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">add\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai-sdk-guardrails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># bun\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">bun\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">add\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai-sdk-guardrails\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"npm install ai-sdk-guardrailspnpm add ai-sdk-guardrailsyarn add ai-sdk-guardrailsbun add ai-sdk-guardrails\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"peer-dependencies\">Peer Dependencies\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#peer-dependencies\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Peer Dependencies”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>AI SDK Guardrails requires the Vercel AI SDK:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"npm install ai\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>You’ll also need at least one AI provider:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># OpenAI\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">@ai-sdk/openai\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Anthropic\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">@ai-sdk/anthropic\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Or any other AI SDK provider\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"npm install @ai-sdk/openainpm install @ai-sdk/anthropic\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"typescript-configuration\">TypeScript Configuration\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#typescript-configuration\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “TypeScript Configuration”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>For optimal TypeScript support, ensure your \u003Ccode dir=\"auto\">tsconfig.json\u003C/code> includes:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"compilerOptions\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"target\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"ES2020\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"module\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"ESNext\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"moduleResolution\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"bundler\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"strict\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"esModuleInterop\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"skipLibCheck\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;compilerOptions&#x22;: {    &#x22;target&#x22;: &#x22;ES2020&#x22;,    &#x22;module&#x22;: &#x22;ESNext&#x22;,    &#x22;moduleResolution&#x22;: &#x22;bundler&#x22;,    &#x22;strict&#x22;: true,    &#x22;esModuleInterop&#x22;: true,    &#x22;skipLibCheck&#x22;: true  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"verify-installation\">Verify Installation\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#verify-installation\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Verify Installation”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Create a simple test file to verify everything is working:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails, piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { generateText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Hello, world!'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">log\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(result.text);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { withGuardrails, piiDetector } from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;import { generateText } from &#x27;ai&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});const result = await generateText({  model,  prompt: &#x27;Hello, world!&#x27;,});console.log(result.text);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>If this runs without errors, you’re all set!\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"environment-variables\">Environment Variables\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#environment-variables\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Environment Variables”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Some guardrails may require API keys. Set these in your \u003Ccode dir=\"auto\">.env\u003C/code> file:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Required for AI SDK\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">OPENAI_API_KEY\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">your-key-here\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Optional: For specific guardrails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># ANTHROPIC_API_KEY=your-key-here\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"OPENAI_API_KEY=your-key-here\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"framework-specific-setup\">Framework-Specific Setup\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#framework-specific-setup\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Framework-Specific Setup”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"nextjs\">Next.js\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#nextjs\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next.js”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>AI SDK Guardrails works seamlessly with Next.js:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">app/api/chat/route.ts\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails, piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { streamText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">export\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">function\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">POST\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">req\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">Request\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">messages\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> req.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">json\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">streamText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">messages,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> result.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toDataStreamResponse\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { withGuardrails, piiDetector } from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;import { streamText } from &#x27;ai&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});export async function POST(req: Request) {  const { messages } = await req.json();  const result = await streamText({    model,    messages,  });  return result.toDataStreamResponse();}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"express\">Express\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#express\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Express”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> express \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'express'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails, piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { generateText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">app\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">express\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">app.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">use\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(express.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">json\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">());\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">app.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">post\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'/api/chat'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">req\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">res\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: req.body.prompt,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">res.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">json\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ text: result.text });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">app.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">listen\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">3000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import express from &#x27;express&#x27;;import { withGuardrails, piiDetector } from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;import { generateText } from &#x27;ai&#x27;;const app = express();app.use(express.json());const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});app.post(&#x27;/api/chat&#x27;, async (req, res) => {  const result = await generateText({    model,    prompt: req.body.prompt,  });  res.json({ text: result.text });});app.listen(3000);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"hono\">Hono\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#hono\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Hono”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { Hono } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'hono'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails, piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { generateText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">app\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">new\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">Hono\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">app.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">post\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'/api/chat'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">c\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">prompt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> c.req.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">json\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> c.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">json\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ text: result.text });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">export\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">default\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> app;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { Hono } from &#x27;hono&#x27;;import { withGuardrails, piiDetector } from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;import { generateText } from &#x27;ai&#x27;;const app = new Hono();const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});app.post(&#x27;/api/chat&#x27;, async (c) => {  const { prompt } = await c.req.json();  const result = await generateText({    model,    prompt,  });  return c.json({ text: result.text });});export default app;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"bundle-size\">Bundle Size\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#bundle-size\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Bundle Size”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>AI SDK Guardrails is designed to be tree-shakeable. Only import the guardrails you actually use:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Good - only imports what you use\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails/guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Avoid - imports everything\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">as\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> guardrails \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// Good - only imports what you useimport { withGuardrails } from &#x27;ai-sdk-guardrails&#x27;;import { piiDetector } from &#x27;ai-sdk-guardrails/guardrails&#x27;;// Avoid - imports everythingimport * as guardrails from &#x27;ai-sdk-guardrails&#x27;;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Typical bundle impact:\u003C/p>\n\u003Cul>\n\u003Cli>Core (\u003Ccode dir=\"auto\">withGuardrails\u003C/code>): ~2KB gzipped\u003C/li>\n\u003Cli>Each guardrail: ~0.5-2KB gzipped\u003C/li>\n\u003Cli>Total with 5 guardrails: ~8-12KB gzipped\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"troubleshooting\">Troubleshooting\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#troubleshooting\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Troubleshooting”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"cannot-find-module-ai-sdk-guardrails\">”Cannot find module ‘ai-sdk-guardrails’”\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#cannot-find-module-ai-sdk-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “”Cannot find module ‘ai-sdk-guardrails’””\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Make sure you’ve installed both \u003Ccode dir=\"auto\">ai-sdk-guardrails\u003C/code> and \u003Ccode dir=\"auto\">ai\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai-sdk-guardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"npm install ai-sdk-guardrails ai\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"typescript-errors\">TypeScript Errors\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#typescript-errors\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “TypeScript Errors”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Ensure your TypeScript version is 5.0 or higher:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">-D\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">typescript@latest\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"npm install -D typescript@latest\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"build-errors-in-nextjs\">Build Errors in Next.js\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#build-errors-in-nextjs\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Build Errors in Next.js”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>If you encounter build errors, add to \u003Ccode dir=\"auto\">next.config.js\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">module\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">exports\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">transpilePackages: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"module.exports = {  transpilePackages: [&#x27;ai-sdk-guardrails&#x27;],};\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/quick-start/\">Quick Start\u003C/a> - Build your first guarded AI application\u003C/li>\n\u003Cli>\u003Ca href=\"/guardrails/input/pii/\">Built-in Guardrails\u003C/a> - Explore available guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/api/with-guardrails/\">API Reference\u003C/a> - Detailed API documentation\u003C/li>\n\u003C/ul>",{"headings":57,"localImagePaths":108,"remoteImagePaths":109,"frontmatter":110,"imagePaths":111},[58,62,65,68,71,74,77,80,84,87,90,93,96,99,102,105],{"depth":59,"slug":60,"text":61},2,"requirements","Requirements",{"depth":59,"slug":63,"text":64},"package-installation","Package Installation",{"depth":59,"slug":66,"text":67},"peer-dependencies","Peer Dependencies",{"depth":59,"slug":69,"text":70},"typescript-configuration","TypeScript Configuration",{"depth":59,"slug":72,"text":73},"verify-installation","Verify Installation",{"depth":59,"slug":75,"text":76},"environment-variables","Environment Variables",{"depth":59,"slug":78,"text":79},"framework-specific-setup","Framework-Specific Setup",{"depth":81,"slug":82,"text":83},3,"nextjs","Next.js",{"depth":81,"slug":85,"text":86},"express","Express",{"depth":81,"slug":88,"text":89},"hono","Hono",{"depth":59,"slug":91,"text":92},"bundle-size","Bundle Size",{"depth":59,"slug":94,"text":95},"troubleshooting","Troubleshooting",{"depth":81,"slug":97,"text":98},"cannot-find-module-ai-sdk-guardrails","”Cannot find module ‘ai-sdk-guardrails’”",{"depth":81,"slug":100,"text":101},"typescript-errors","TypeScript Errors",{"depth":81,"slug":103,"text":104},"build-errors-in-nextjs","Build Errors in Next.js",{"depth":59,"slug":106,"text":107},"next-steps","Next Steps",[],[],{"title":45,"description":46},[],"installation.md","quick-start",{"id":113,"data":115,"body":121,"filePath":122,"digest":123,"rendered":124,"legacyId":158},{"title":116,"description":117,"editUrl":16,"head":118,"template":48,"sidebar":119,"pagefind":16,"draft":36},"Quick Start","Get started with AI SDK Guardrails",[],{"hidden":36,"attrs":120},{},"This guide shows you how to add guardrails to your AI SDK application.\n\n## Installation\n\n```bash\nnpm install ai-sdk-guardrails\n```\n\nRequires `ai` SDK v4.0+ and Node.js 22+.\n\n## Basic Usage\n\nWrap your AI SDK model with guardrails:\n\n```ts\nimport { withGuardrails, piiDetector } from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\nimport { generateText } from 'ai';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\nconst { text } = await generateText({\n  model,\n  prompt: 'Analyze this customer request...',\n});\n```\n\n## Input Guardrails\n\nInput guardrails run before the model receives the request:\n\n```ts\nimport { piiDetector, promptInjectionDetector, blockedKeywords } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    piiDetector(),\n    promptInjectionDetector(),\n    blockedKeywords(['spam', 'scam']),\n  ],\n});\n```\n\n## Output Guardrails\n\nOutput guardrails run after the model generates a response:\n\n```ts\nimport { sensitiveDataFilter, minLengthRequirement } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    sensitiveDataFilter(),\n    minLengthRequirement(50),\n  ],\n});\n```\n\n## Combining Guardrails\n\nUse both input and output guardrails together:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    piiDetector(),\n    promptInjectionDetector(),\n  ],\n  outputGuardrails: [\n    sensitiveDataFilter(),\n    minLengthRequirement(50),\n  ],\n});\n```\n\n## Handling Violations\n\nBy default, guardrails throw errors when blocked. Handle them with try-catch:\n\n```ts\nimport { isGuardrailsError } from 'ai-sdk-guardrails';\n\ntry {\n  const { text } = await generateText({\n    model,\n    prompt: 'My email is john@company.com',\n  });\n} catch (error) {\n  if (isGuardrailsError(error)) {\n    console.log('Blocked:', error.message);\n    console.log('Severity:', error.severity);\n  }\n}\n```\n\n## Warning Mode\n\nUse callbacks instead of throwing errors:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n  throwOnBlocked: false,\n  onInputBlocked: (summary) => {\n    console.log('Input blocked:', summary.blockedResults);\n  },\n});\n```\n\n## Streaming\n\nGuardrails work with streaming:\n\n```ts\nimport { streamText } from 'ai';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n});\n\nconst { textStream } = await streamText({\n  model,\n  prompt: 'Write a summary...',\n});\n\nfor await (const chunk of textStream) {\n  process.stdout.write(chunk);\n}\n```\n\n## OpenAI Config Compatibility\n\nLoad configs from [guardrails.openai.com](https://guardrails.openai.com):\n\n```ts\nimport { mapOpenAIConfigToGuardrails, loadPipelineConfig } from 'ai-sdk-guardrails';\n\n// Load from file\nconst config = await loadPipelineConfig('./guardrails-config.json');\nconst guardrailsConfig = mapOpenAIConfigToGuardrails(config);\n\nconst model = withGuardrails(openai('gpt-4o'), guardrailsConfig);\n```\n\nOr use the config directly:\n\n```ts\nconst config = {\n  version: 1,\n  input: {\n    version: 1,\n    guardrails: [\n      {\n        name: 'Contains PII',\n        config: { entities: ['EMAIL_ADDRESS', 'PHONE_NUMBER'] },\n      },\n    ],\n  },\n};\n\nconst guardrailsConfig = mapOpenAIConfigToGuardrails(config);\nconst model = withGuardrails(openai('gpt-4o'), guardrailsConfig);\n```\n\n## Next Steps\n\n- [Built-in Guardrails](/reference/built-in-guardrails/) - Explore all available guardrails\n- [Custom Guardrails](/guides/custom-guardrails/) - Create your own guardrails\n- [Streaming Guide](/guides/streaming/) - Streaming patterns\n- [OpenAI Configs](/guides/openai-configs/) - Working with OpenAI config format","src/content/docs/quick-start.md","1b5d8bb0e54d0db1",{"html":125,"metadata":126},"\u003Cp>This guide shows you how to add guardrails to your AI SDK application.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"installation\">Installation\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#installation\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Installation”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal not-content\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">npm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">install\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">ai-sdk-guardrails\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"npm install ai-sdk-guardrails\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Requires \u003Ccode dir=\"auto\">ai\u003C/code> SDK v4.0+ and Node.js 22+.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"basic-usage\">Basic Usage\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#basic-usage\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Basic Usage”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Wrap your AI SDK model with guardrails:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails, piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { generateText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Analyze this customer request...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { withGuardrails, piiDetector } from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;import { generateText } from &#x27;ai&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});const { text } = await generateText({  model,  prompt: &#x27;Analyze this customer request...&#x27;,});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"input-guardrails\">Input Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#input-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Input guardrails run before the model receives the request:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { piiDetector, promptInjectionDetector, blockedKeywords } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">blockedKeywords\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">([\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'spam'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'scam'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">]),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { piiDetector, promptInjectionDetector, blockedKeywords } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    piiDetector(),    promptInjectionDetector(),    blockedKeywords([&#x27;spam&#x27;, &#x27;scam&#x27;]),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"output-guardrails\">Output Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#output-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Output Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Output guardrails run after the model generates a response:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { sensitiveDataFilter, minLengthRequirement } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">50\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { sensitiveDataFilter, minLengthRequirement } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    sensitiveDataFilter(),    minLengthRequirement(50),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"combining-guardrails\">Combining Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#combining-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Combining Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Use both input and output guardrails together:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">50\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    piiDetector(),    promptInjectionDetector(),  ],  outputGuardrails: [    sensitiveDataFilter(),    minLengthRequirement(50),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"handling-violations\">Handling Violations\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#handling-violations\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Handling Violations”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>By default, guardrails throw errors when blocked. Handle them with try-catch:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { isGuardrailsError } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">try\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'My email is john@company.com'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">catch\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (error) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">isGuardrailsError\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(error)) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">log\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, error.message);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">log\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Severity:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, error.severity);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { isGuardrailsError } from &#x27;ai-sdk-guardrails&#x27;;try {  const { text } = await generateText({    model,    prompt: &#x27;My email is john@company.com&#x27;,  });} catch (error) {  if (isGuardrailsError(error)) {    console.log(&#x27;Blocked:&#x27;, error.message);    console.log(&#x27;Severity:&#x27;, error.severity);  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"warning-mode\">Warning Mode\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#warning-mode\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Warning Mode”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Use callbacks instead of throwing errors:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">throwOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">onInputBlocked\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">summary\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">log\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Input blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, summary.blockedResults);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],  throwOnBlocked: false,  onInputBlocked: (summary) => {    console.log(&#x27;Input blocked:&#x27;, summary.blockedResults);  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"streaming\">Streaming\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#streaming\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Streaming”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Guardrails work with streaming:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { streamText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">textStream\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">streamText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Write a summary...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">for\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">chunk\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">of\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> textStream) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">process.stdout.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">write\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(chunk);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { streamText } from &#x27;ai&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],});const { textStream } = await streamText({  model,  prompt: &#x27;Write a summary...&#x27;,});for await (const chunk of textStream) {  process.stdout.write(chunk);}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"openai-config-compatibility\">OpenAI Config Compatibility\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#openai-config-compatibility\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “OpenAI Config Compatibility”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Load configs from \u003Ca href=\"https://guardrails.openai.com\">guardrails.openai.com\u003C/a>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { mapOpenAIConfigToGuardrails, loadPipelineConfig } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Load from file\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">config\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">loadPipelineConfig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'./guardrails-config.json'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">guardrailsConfig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">mapOpenAIConfigToGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(config);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), guardrailsConfig);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { mapOpenAIConfigToGuardrails, loadPipelineConfig } from &#x27;ai-sdk-guardrails&#x27;;// Load from fileconst config = await loadPipelineConfig(&#x27;./guardrails-config.json&#x27;);const guardrailsConfig = mapOpenAIConfigToGuardrails(config);const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), guardrailsConfig);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Or use the config directly:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">config\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">version: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">input: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">version: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">guardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Contains PII'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">config: { entities: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'EMAIL_ADDRESS'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'PHONE_NUMBER'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">] },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">guardrailsConfig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">mapOpenAIConfigToGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(config);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), guardrailsConfig);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const config = {  version: 1,  input: {    version: 1,    guardrails: [      {        name: &#x27;Contains PII&#x27;,        config: { entities: [&#x27;EMAIL_ADDRESS&#x27;, &#x27;PHONE_NUMBER&#x27;] },      },    ],  },};const guardrailsConfig = mapOpenAIConfigToGuardrails(config);const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), guardrailsConfig);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/reference/built-in-guardrails/\">Built-in Guardrails\u003C/a> - Explore all available guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/custom-guardrails/\">Custom Guardrails\u003C/a> - Create your own guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/streaming/\">Streaming Guide\u003C/a> - Streaming patterns\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/openai-configs/\">OpenAI Configs\u003C/a> - Working with OpenAI config format\u003C/li>\n\u003C/ul>",{"headings":127,"localImagePaths":154,"remoteImagePaths":155,"frontmatter":156,"imagePaths":157},[128,129,132,135,138,141,144,147,150,153],{"depth":59,"slug":42,"text":45},{"depth":59,"slug":130,"text":131},"basic-usage","Basic Usage",{"depth":59,"slug":133,"text":134},"input-guardrails","Input Guardrails",{"depth":59,"slug":136,"text":137},"output-guardrails","Output Guardrails",{"depth":59,"slug":139,"text":140},"combining-guardrails","Combining Guardrails",{"depth":59,"slug":142,"text":143},"handling-violations","Handling Violations",{"depth":59,"slug":145,"text":146},"warning-mode","Warning Mode",{"depth":59,"slug":148,"text":149},"streaming","Streaming",{"depth":59,"slug":151,"text":152},"openai-config-compatibility","OpenAI Config Compatibility",{"depth":59,"slug":106,"text":107},[],[],{"title":116,"description":117},[],"quick-start.md","core-concepts/how-it-works",{"id":159,"data":161,"body":167,"filePath":168,"digest":169,"rendered":170,"legacyId":204},{"title":162,"description":163,"editUrl":16,"head":164,"template":48,"sidebar":165,"pagefind":16,"draft":36},"How Guardrails Work","Understanding the architecture and execution flow of AI SDK Guardrails",[],{"hidden":36,"attrs":166},{},"Guardrails run **in parallel** with your AI calls as middleware, providing a non-invasive way to add safety and quality controls.\n\n## Architecture\n\n```mermaid\nflowchart LR\n  A[Input] --> B[Input Guardrails]\n  B -->|✅ Clean| C[AI Model]\n  B -->|❌ Blocked| X[No API Call]\n  C --> D[Output Guardrails]\n  D -->|✅ Clean| E[Response]\n  D -->|❌ Blocked| R[Retry/Replace/Block]\n```\n\n## Three-Step Workflow\n\n1. **Receive**: Input or output arrives\n2. **Check**: Guardrails run (PII detection, validation, etc.)\n3. **Decide**: Pass through, block, or retry\n\n## Middleware Pattern\n\nGuardrails are implemented as middleware, which means:\n\n- **Non-invasive**: Your existing code doesn't change\n- **Composable**: Stack multiple guardrails together\n- **Observable**: Works with your existing telemetry and logging\n- **Flexible**: Add, remove, or modify guardrails without touching core logic\n\n## Input Guardrails\n\nInput guardrails run **before** the AI model is called:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    piiDetector(),           // Check for PII\n    promptInjectionDetector(), // Check for injection\n  ],\n});\n```\n\n**Benefits:**\n- ✅ Block bad requests before API costs\n- ✅ Prevent compliance violations\n- ✅ Protect against prompt injection\n- ✅ No wasted tokens\n\n## Output Guardrails\n\nOutput guardrails run **after** the AI model responds:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    sensitiveDataFilter(),    // Remove secrets\n    minLengthRequirement(100), // Enforce quality\n  ],\n});\n```\n\n**Behaviors:**\n- **Block**: Prevent response from being returned\n- **Replace**: Return a safe fallback message\n- **Retry**: Automatically retry with modified parameters\n- **Warn**: Log violation but allow response\n\n## Streaming Support\n\nGuardrails work seamlessly with streaming:\n\n### Buffer Mode (Default)\n\nWait for the entire stream to complete, then check:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n  streamMode: 'buffer', // Default\n});\n```\n\n**When to use:**\n- Need to validate complete responses\n- Running quality checks that require full text\n- Checking output length or structure\n\n### Progressive Mode\n\nCheck guardrails as tokens arrive (early termination):\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [toxicityFilter()],\n  streamMode: 'progressive',\n});\n```\n\n**When to use:**\n- Need to stop generation early\n- Detecting violations in real-time\n- Saving costs by early termination\n\n## Parallel Execution\n\nAll guardrails in a group run in parallel for maximum performance:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    piiDetector(),           // Runs in parallel\n    promptInjectionDetector(), // Runs in parallel\n    profanityFilter(),        // Runs in parallel\n  ],\n});\n```\n\n**Result**: Fastest possible validation with minimal latency.\n\n## Error Handling\n\nGuardrails can be configured to handle errors gracefully:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n  throwOnBlocked: true,  // Throw errors\n  continueOnFailure: true, // Continue if guardrail fails\n});\n```\n\nSee [Error Handling](/error-handling/) for detailed strategies.","src/content/docs/core-concepts/how-it-works.md","96b8b5715f6db3d3",{"html":171,"metadata":172},"\u003Cp>Guardrails run \u003Cstrong>in parallel\u003C/strong> with your AI calls as middleware, providing a non-invasive way to add safety and quality controls.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"architecture\">Architecture\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#architecture\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Architecture”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"mermaid\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">flowchart LR\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">A[Input] --> B[Input Guardrails]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">B -->|✅ Clean| C[AI Model]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">B -->|❌ Blocked| X[No API Call]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">C --> D[Output Guardrails]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">D -->|✅ Clean| E[Response]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">D -->|❌ Blocked| R[Retry/Replace/Block]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"flowchart LR  A[Input] --> B[Input Guardrails]  B -->|✅ Clean| C[AI Model]  B -->|❌ Blocked| X[No API Call]  C --> D[Output Guardrails]  D -->|✅ Clean| E[Response]  D -->|❌ Blocked| R[Retry/Replace/Block]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"three-step-workflow\">Three-Step Workflow\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#three-step-workflow\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Three-Step Workflow”\u003C/span>\u003C/a>\u003C/div>\n\u003Col>\n\u003Cli>\u003Cstrong>Receive\u003C/strong>: Input or output arrives\u003C/li>\n\u003Cli>\u003Cstrong>Check\u003C/strong>: Guardrails run (PII detection, validation, etc.)\u003C/li>\n\u003Cli>\u003Cstrong>Decide\u003C/strong>: Pass through, block, or retry\u003C/li>\n\u003C/ol>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"middleware-pattern\">Middleware Pattern\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#middleware-pattern\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Middleware Pattern”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Guardrails are implemented as middleware, which means:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Non-invasive\u003C/strong>: Your existing code doesn’t change\u003C/li>\n\u003Cli>\u003Cstrong>Composable\u003C/strong>: Stack multiple guardrails together\u003C/li>\n\u003Cli>\u003Cstrong>Observable\u003C/strong>: Works with your existing telemetry and logging\u003C/li>\n\u003Cli>\u003Cstrong>Flexible\u003C/strong>: Add, remove, or modify guardrails without touching core logic\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"input-guardrails\">Input Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#input-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Input guardrails run \u003Cstrong>before\u003C/strong> the AI model is called:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),           \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Check for PII\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Check for injection\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    piiDetector(),           // Check for PII    promptInjectionDetector(), // Check for injection  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Benefits:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>✅ Block bad requests before API costs\u003C/li>\n\u003Cli>✅ Prevent compliance violations\u003C/li>\n\u003Cli>✅ Protect against prompt injection\u003C/li>\n\u003Cli>✅ No wasted tokens\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"output-guardrails\">Output Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#output-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Output Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Output guardrails run \u003Cstrong>after\u003C/strong> the AI model responds:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Remove secrets\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Enforce quality\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    sensitiveDataFilter(),    // Remove secrets    minLengthRequirement(100), // Enforce quality  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Behaviors:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Block\u003C/strong>: Prevent response from being returned\u003C/li>\n\u003Cli>\u003Cstrong>Replace\u003C/strong>: Return a safe fallback message\u003C/li>\n\u003Cli>\u003Cstrong>Retry\u003C/strong>: Automatically retry with modified parameters\u003C/li>\n\u003Cli>\u003Cstrong>Warn\u003C/strong>: Log violation but allow response\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"streaming-support\">Streaming Support\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#streaming-support\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Streaming Support”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Guardrails work seamlessly with streaming:\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"buffer-mode-default\">Buffer Mode (Default)\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#buffer-mode-default\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Buffer Mode (Default)”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Wait for the entire stream to complete, then check:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">streamMode: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'buffer'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Default\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],  streamMode: &#x27;buffer&#x27;, // Default});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>When to use:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Need to validate complete responses\u003C/li>\n\u003Cli>Running quality checks that require full text\u003C/li>\n\u003Cli>Checking output length or structure\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"progressive-mode\">Progressive Mode\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#progressive-mode\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Progressive Mode”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Check guardrails as tokens arrive (early termination):\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">streamMode: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'progressive'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [toxicityFilter()],  streamMode: &#x27;progressive&#x27;,});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>When to use:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Need to stop generation early\u003C/li>\n\u003Cli>Detecting violations in real-time\u003C/li>\n\u003Cli>Saving costs by early termination\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"parallel-execution\">Parallel Execution\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#parallel-execution\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Parallel Execution”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>All guardrails in a group run in parallel for maximum performance:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),           \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Runs in parallel\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Runs in parallel\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">profanityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),        \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Runs in parallel\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    piiDetector(),           // Runs in parallel    promptInjectionDetector(), // Runs in parallel    profanityFilter(),        // Runs in parallel  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Result\u003C/strong>: Fastest possible validation with minimal latency.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"error-handling\">Error Handling\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#error-handling\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Error Handling”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Guardrails can be configured to handle errors gracefully:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">throwOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,  \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Throw errors\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">continueOnFailure: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Continue if guardrail fails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],  throwOnBlocked: true,  // Throw errors  continueOnFailure: true, // Continue if guardrail fails});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>See \u003Ca href=\"/error-handling/\">Error Handling\u003C/a> for detailed strategies.\u003C/p>",{"headings":173,"localImagePaths":200,"remoteImagePaths":201,"frontmatter":202,"imagePaths":203},[174,177,180,183,184,185,188,191,194,197],{"depth":59,"slug":175,"text":176},"architecture","Architecture",{"depth":59,"slug":178,"text":179},"three-step-workflow","Three-Step Workflow",{"depth":59,"slug":181,"text":182},"middleware-pattern","Middleware Pattern",{"depth":59,"slug":133,"text":134},{"depth":59,"slug":136,"text":137},{"depth":59,"slug":186,"text":187},"streaming-support","Streaming Support",{"depth":81,"slug":189,"text":190},"buffer-mode-default","Buffer Mode (Default)",{"depth":81,"slug":192,"text":193},"progressive-mode","Progressive Mode",{"depth":59,"slug":195,"text":196},"parallel-execution","Parallel Execution",{"depth":59,"slug":198,"text":199},"error-handling","Error Handling",[],[],{"title":162,"description":163},[],"core-concepts/how-it-works.md","guides/custom-guardrails",{"id":205,"data":207,"body":213,"filePath":214,"digest":215,"rendered":216,"legacyId":265},{"title":208,"description":209,"editUrl":16,"head":210,"template":48,"sidebar":211,"pagefind":16,"draft":36},"Custom Guardrails","Create domain-specific guardrails for your application",[],{"hidden":36,"attrs":212},{},"Create custom guardrails tailored to your application's specific requirements.\n\n## Input Guardrails\n\nInput guardrails check prompts before they reach the AI model.\n\n### Basic Example\n\n```ts\nimport { defineInputGuardrail } from 'ai-sdk-guardrails';\nimport { extractTextContent } from 'ai-sdk-guardrails/guardrails/input';\n\nconst businessHoursGuardrail = defineInputGuardrail({\n  name: 'business-hours',\n  description: 'Only allow requests during business hours',\n  execute: async (params) => {\n    const hour = new Date().getHours();\n\n    if (hour >= 9 && hour \u003C= 17) {\n      return { tripwireTriggered: false };\n    }\n\n    return {\n      tripwireTriggered: true,\n      message: 'Requests only allowed during business hours (9 AM - 5 PM)',\n      severity: 'medium',\n      metadata: { currentHour: hour },\n    };\n  },\n});\n```\n\n### With Text Extraction\n\n```ts\nconst maxLengthGuardrail = defineInputGuardrail({\n  name: 'max-length',\n  description: 'Limit input length',\n  execute: async (params) => {\n    const { prompt } = extractTextContent(params);\n    const maxLength = 1000;\n\n    if (prompt.length \u003C= maxLength) {\n      return { tripwireTriggered: false };\n    }\n\n    return {\n      tripwireTriggered: true,\n      message: `Input too long: ${prompt.length} chars (max: ${maxLength})`,\n      severity: 'high',\n      metadata: {\n        length: prompt.length,\n        maxLength,\n        exceeded: prompt.length - maxLength,\n      },\n    };\n  },\n});\n```\n\n### Async Validation\n\n```ts\nconst allowlistGuardrail = defineInputGuardrail({\n  name: 'user-allowlist',\n  description: 'Only allow approved users',\n  execute: async (params) => {\n    const { prompt } = extractTextContent(params);\n    const userId = params.userId; // From custom metadata\n\n    // Check database\n    const isAllowed = await db.users.isAllowed(userId);\n\n    if (isAllowed) {\n      return { tripwireTriggered: false };\n    }\n\n    return {\n      tripwireTriggered: true,\n      message: 'User not approved for AI access',\n      severity: 'critical',\n    };\n  },\n});\n```\n\n## Output Guardrails\n\nOutput guardrails check AI responses before returning them to users.\n\n### Basic Example\n\n```ts\nimport { defineOutputGuardrail } from 'ai-sdk-guardrails';\nimport { extractContent } from 'ai-sdk-guardrails/guardrails/output';\n\nconst minQualityGuardrail = defineOutputGuardrail({\n  name: 'min-quality',\n  description: 'Ensure responses meet minimum quality standards',\n  execute: async ({ result }) => {\n    const { text } = extractContent(result);\n    const minLength = 100;\n\n    if (text.length >= minLength) {\n      return { tripwireTriggered: false };\n    }\n\n    return {\n      tripwireTriggered: true,\n      message: `Response too short: ${text.length} chars (min: ${minLength})`,\n      severity: 'medium',\n      metadata: { length: text.length, minLength },\n    };\n  },\n});\n```\n\n### With Structured Outputs\n\n```ts\nconst companyPolicyGuardrail = defineOutputGuardrail({\n  name: 'company-policy',\n  description: 'Enforce company communication policy',\n  execute: async ({ result }) => {\n    const { text } = extractContent(result);\n\n    const bannedPhrases = [\n      'guaranteed results',\n      'risk-free',\n      'limited time only',\n    ];\n\n    const violations = bannedPhrases.filter((phrase) =>\n      text.toLowerCase().includes(phrase)\n    );\n\n    if (violations.length === 0) {\n      return { tripwireTriggered: false };\n    }\n\n    return {\n      tripwireTriggered: true,\n      message: 'Response violates company policy',\n      severity: 'high',\n      metadata: { violations },\n    };\n  },\n});\n```\n\n### LLM-as-Judge Pattern\n\nUse another LLM to validate responses:\n\n```ts\nimport { generateObject } from 'ai';\nimport { z } from 'zod';\n\nconst llmJudgeGuardrail = defineOutputGuardrail({\n  name: 'llm-quality-judge',\n  description: 'Use LLM to assess response quality',\n  execute: async ({ result }) => {\n    const { text } = extractContent(result);\n\n    const assessment = await generateObject({\n      model: openai('gpt-4o-mini'), // Cheaper model for judging\n      schema: z.object({\n        isQuality: z.boolean(),\n        reason: z.string(),\n        score: z.number().min(0).max(10),\n      }),\n      prompt: `\n        Assess if this response is helpful and complete:\n        \"${text}\"\n\n        Rate quality (0-10) and explain why.\n      `,\n    });\n\n    if (assessment.object.score >= 7) {\n      return { tripwireTriggered: false };\n    }\n\n    return {\n      tripwireTriggered: true,\n      message: `Low quality response (score: ${assessment.object.score})`,\n      severity: 'medium',\n      metadata: assessment.object,\n    };\n  },\n});\n```\n\n## Configurable Guardrails\n\nCreate guardrails with configurable parameters:\n\n```ts\nfunction createLengthGuardrail(options: {\n  minLength?: number;\n  maxLength?: number;\n}) {\n  return defineOutputGuardrail({\n    name: 'length-requirement',\n    description: 'Enforce length requirements',\n    execute: async ({ result }) => {\n      const { text } = extractContent(result);\n      const { minLength = 0, maxLength = Infinity } = options;\n\n      if (text.length \u003C minLength) {\n        return {\n          tripwireTriggered: true,\n          message: `Response too short: ${text.length} \u003C ${minLength}`,\n          severity: 'medium',\n        };\n      }\n\n      if (text.length > maxLength) {\n        return {\n          tripwireTriggered: true,\n          message: `Response too long: ${text.length} > ${maxLength}`,\n          severity: 'low',\n        };\n      }\n\n      return { tripwireTriggered: false };\n    },\n  });\n}\n\n// Usage\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    createLengthGuardrail({ minLength: 100, maxLength: 500 }),\n  ],\n});\n```\n\n## Conditional Guardrails\n\nApply guardrails based on conditions:\n\n```ts\nconst conditionalGuardrail = defineInputGuardrail({\n  name: 'production-only',\n  description: 'Stricter rules in production',\n  execute: async (params) => {\n    // Skip in development\n    if (process.env.NODE_ENV !== 'production') {\n      return { tripwireTriggered: false };\n    }\n\n    // Strict validation in production\n    const { prompt } = extractTextContent(params);\n\n    if (prompt.length > 500) {\n      return {\n        tripwireTriggered: true,\n        message: 'Production input limit exceeded',\n        severity: 'high',\n      };\n    }\n\n    return { tripwireTriggered: false };\n  },\n});\n```\n\n## Best Practices\n\n### 1. Descriptive Names and Messages\n\n```ts\nconst goodGuardrail = defineInputGuardrail({\n  name: 'pii-email-detector',\n  description: 'Detects and blocks email addresses in user input',\n  execute: async (params) => {\n    // ... validation\n    return {\n      tripwireTriggered: true,\n      message: 'Email address detected. Please remove PII before submitting.',\n      severity: 'critical',\n      metadata: { detectedPattern: 'email' },\n    };\n  },\n});\n```\n\n### 2. Use Appropriate Severity Levels\n\n- **`critical`**: Security violations, PII leaks, compliance issues\n- **`high`**: Quality failures, policy violations\n- **`medium`**: Warning-level issues, soft limits\n- **`low`**: Minor issues, informational\n\n### 3. Include Metadata\n\n```ts\nreturn {\n  tripwireTriggered: true,\n  message: 'Rate limit exceeded',\n  severity: 'high',\n  metadata: {\n    userId: params.userId,\n    requestCount: currentCount,\n    limit: maxRequests,\n    resetTime: resetTimestamp,\n  },\n};\n```\n\n### 4. Handle Errors Gracefully\n\n```ts\nconst guardrail = defineInputGuardrail({\n  name: 'external-check',\n  execute: async (params) => {\n    try {\n      const result = await externalAPI.check(params);\n      return result.isValid\n        ? { tripwireTriggered: false }\n        : { tripwireTriggered: true, message: 'Validation failed' };\n    } catch (error) {\n      // Log error but don't block user\n      console.error('Guardrail error:', error);\n      return { tripwireTriggered: false }; // Fail open\n    }\n  },\n});\n```\n\n## Next Steps\n\n- [Built-in Guardrails](/reference/built-in-guardrails/) - See examples of built-in guardrails\n- [API Reference](/reference/api/) - Complete guardrail API\n- [Testing Guardrails](/guides/testing/) - How to test custom guardrails","src/content/docs/guides/custom-guardrails.md","5c21a8dcb6db44cd",{"html":217,"metadata":218},"\u003Cp>Create custom guardrails tailored to your application’s specific requirements.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"input-guardrails\">Input Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#input-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Input guardrails check prompts before they reach the AI model.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"basic-example\">Basic Example\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#basic-example\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Basic Example”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { defineInputGuardrail } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { extractTextContent } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails/guardrails/input'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">businessHoursGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineInputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'business-hours'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Only allow requests during business hours'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">hour\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">new\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">Date\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">().\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">getHours\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (hour \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">>=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">9\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> hour \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">&#x3C;=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">17\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Requests only allowed during business hours (9 AM - 5 PM)'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'medium'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: { currentHour: hour },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { defineInputGuardrail } from &#x27;ai-sdk-guardrails&#x27;;import { extractTextContent } from &#x27;ai-sdk-guardrails/guardrails/input&#x27;;const businessHoursGuardrail = defineInputGuardrail({  name: &#x27;business-hours&#x27;,  description: &#x27;Only allow requests during business hours&#x27;,  execute: async (params) => {    const hour = new Date().getHours();    if (hour >= 9 &#x26;&#x26; hour \u003C= 17) {      return { tripwireTriggered: false };    }    return {      tripwireTriggered: true,      message: &#x27;Requests only allowed during business hours (9 AM - 5 PM)&#x27;,      severity: &#x27;medium&#x27;,      metadata: { currentHour: hour },    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"with-text-extraction\">With Text Extraction\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#with-text-extraction\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “With Text Extraction”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">maxLengthGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineInputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'max-length'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Limit input length'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">prompt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractTextContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(params);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">maxLength\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (prompt.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">&#x3C;=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> maxLength) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`Input too long: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">} chars (max: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxLength\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">})`\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'high'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">length: prompt.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxLength,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">exceeded: prompt.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> maxLength,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const maxLengthGuardrail = defineInputGuardrail({  name: &#x27;max-length&#x27;,  description: &#x27;Limit input length&#x27;,  execute: async (params) => {    const { prompt } = extractTextContent(params);    const maxLength = 1000;    if (prompt.length \u003C= maxLength) {      return { tripwireTriggered: false };    }    return {      tripwireTriggered: true,      message: &#x60;Input too long: ${prompt.length} chars (max: ${maxLength})&#x60;,      severity: &#x27;high&#x27;,      metadata: {        length: prompt.length,        maxLength,        exceeded: prompt.length - maxLength,      },    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"async-validation\">Async Validation\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#async-validation\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Async Validation”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">allowlistGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineInputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'user-allowlist'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Only allow approved users'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">prompt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractTextContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(params);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">userId\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> params.userId; \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// From custom metadata\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Check database\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">isAllowed\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> db.users.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">isAllowed\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(userId);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (isAllowed) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'User not approved for AI access'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'critical'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const allowlistGuardrail = defineInputGuardrail({  name: &#x27;user-allowlist&#x27;,  description: &#x27;Only allow approved users&#x27;,  execute: async (params) => {    const { prompt } = extractTextContent(params);    const userId = params.userId; // From custom metadata    // Check database    const isAllowed = await db.users.isAllowed(userId);    if (isAllowed) {      return { tripwireTriggered: false };    }    return {      tripwireTriggered: true,      message: &#x27;User not approved for AI access&#x27;,      severity: &#x27;critical&#x27;,    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"output-guardrails\">Output Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#output-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Output Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Output guardrails check AI responses before returning them to users.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"basic-example-1\">Basic Example\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#basic-example-1\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Basic Example”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { defineOutputGuardrail } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { extractContent } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails/guardrails/output'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">minQualityGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineOutputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'min-quality'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Ensure responses meet minimum quality standards'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> ({ \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(result);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">minLength\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (text.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">>=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> minLength) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`Response too short: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">text\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">} chars (min: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">minLength\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">})`\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'medium'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: { length: text.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, minLength },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { defineOutputGuardrail } from &#x27;ai-sdk-guardrails&#x27;;import { extractContent } from &#x27;ai-sdk-guardrails/guardrails/output&#x27;;const minQualityGuardrail = defineOutputGuardrail({  name: &#x27;min-quality&#x27;,  description: &#x27;Ensure responses meet minimum quality standards&#x27;,  execute: async ({ result }) => {    const { text } = extractContent(result);    const minLength = 100;    if (text.length >= minLength) {      return { tripwireTriggered: false };    }    return {      tripwireTriggered: true,      message: &#x60;Response too short: ${text.length} chars (min: ${minLength})&#x60;,      severity: &#x27;medium&#x27;,      metadata: { length: text.length, minLength },    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"with-structured-outputs\">With Structured Outputs\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#with-structured-outputs\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “With Structured Outputs”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">companyPolicyGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineOutputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'company-policy'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Enforce company communication policy'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> ({ \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(result);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">bannedPhrases\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'guaranteed results'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'risk-free'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'limited time only'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">violations\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> bannedPhrases.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">filter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">((\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">phrase\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">text.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toLowerCase\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">().\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">includes\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(phrase)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (violations.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">===\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Response violates company policy'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'high'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: { violations },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const companyPolicyGuardrail = defineOutputGuardrail({  name: &#x27;company-policy&#x27;,  description: &#x27;Enforce company communication policy&#x27;,  execute: async ({ result }) => {    const { text } = extractContent(result);    const bannedPhrases = [      &#x27;guaranteed results&#x27;,      &#x27;risk-free&#x27;,      &#x27;limited time only&#x27;,    ];    const violations = bannedPhrases.filter((phrase) =>      text.toLowerCase().includes(phrase)    );    if (violations.length === 0) {      return { tripwireTriggered: false };    }    return {      tripwireTriggered: true,      message: &#x27;Response violates company policy&#x27;,      severity: &#x27;high&#x27;,      metadata: { violations },    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"llm-as-judge-pattern\">LLM-as-Judge Pattern\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#llm-as-judge-pattern\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “LLM-as-Judge Pattern”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Use another LLM to validate responses:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { generateObject } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { z } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'zod'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">llmJudgeGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineOutputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'llm-quality-judge'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Use LLM to assess response quality'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> ({ \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(result);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">assessment\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateObject\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model: \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o-mini'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Cheaper model for judging\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">schema: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">isQuality: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">boolean\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">reason: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">string\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">score: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">number\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">().\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">min\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">).\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">max\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">10\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">Assess if this response is helpful and complete:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">text\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">}\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">Rate quality (0-10) and explain why.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (assessment.object.score \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">>=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">7\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`Low quality response (score: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">assessment\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">.\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">object\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">.\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">score\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">})`\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'medium'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: assessment.object,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { generateObject } from &#x27;ai&#x27;;import { z } from &#x27;zod&#x27;;const llmJudgeGuardrail = defineOutputGuardrail({  name: &#x27;llm-quality-judge&#x27;,  description: &#x27;Use LLM to assess response quality&#x27;,  execute: async ({ result }) => {    const { text } = extractContent(result);    const assessment = await generateObject({      model: openai(&#x27;gpt-4o-mini&#x27;), // Cheaper model for judging      schema: z.object({        isQuality: z.boolean(),        reason: z.string(),        score: z.number().min(0).max(10),      }),      prompt: &#x60;        Assess if this response is helpful and complete:        &#x22;${text}&#x22;        Rate quality (0-10) and explain why.      &#x60;,    });    if (assessment.object.score >= 7) {      return { tripwireTriggered: false };    }    return {      tripwireTriggered: true,      message: &#x60;Low quality response (score: ${assessment.object.score})&#x60;,      severity: &#x27;medium&#x27;,      metadata: assessment.object,    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"configurable-guardrails\">Configurable Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#configurable-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Configurable Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Create guardrails with configurable parameters:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">function\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">createLengthGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">options\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">minLength\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">?:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">number\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">maxLength\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">?:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">number\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineOutputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'length-requirement'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Enforce length requirements'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> ({ \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(result);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">minLength\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">maxLength\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">Infinity\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> options;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (text.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> minLength) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`Response too short: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">text\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">} &#x3C; ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">minLength\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">}`\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'medium'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (text.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> maxLength) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">`Response too long: ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">text\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">} > ${\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxLength\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">}`\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'low'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Usage\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">createLengthGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ minLength: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, maxLength: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">500\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"function createLengthGuardrail(options: {  minLength?: number;  maxLength?: number;}) {  return defineOutputGuardrail({    name: &#x27;length-requirement&#x27;,    description: &#x27;Enforce length requirements&#x27;,    execute: async ({ result }) => {      const { text } = extractContent(result);      const { minLength = 0, maxLength = Infinity } = options;      if (text.length \u003C minLength) {        return {          tripwireTriggered: true,          message: &#x60;Response too short: ${text.length} \u003C ${minLength}&#x60;,          severity: &#x27;medium&#x27;,        };      }      if (text.length > maxLength) {        return {          tripwireTriggered: true,          message: &#x60;Response too long: ${text.length} > ${maxLength}&#x60;,          severity: &#x27;low&#x27;,        };      }      return { tripwireTriggered: false };    },  });}// Usageconst model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    createLengthGuardrail({ minLength: 100, maxLength: 500 }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"conditional-guardrails\">Conditional Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#conditional-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Conditional Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Apply guardrails based on conditions:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">conditionalGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineInputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'production-only'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Stricter rules in production'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Skip in development\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (process.env.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">NODE_ENV\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">!==\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'production'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Strict validation in production\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">prompt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">extractTextContent\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(params);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (prompt.\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">length\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">500\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Production input limit exceeded'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'high'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const conditionalGuardrail = defineInputGuardrail({  name: &#x27;production-only&#x27;,  description: &#x27;Stricter rules in production&#x27;,  execute: async (params) => {    // Skip in development    if (process.env.NODE_ENV !== &#x27;production&#x27;) {      return { tripwireTriggered: false };    }    // Strict validation in production    const { prompt } = extractTextContent(params);    if (prompt.length > 500) {      return {        tripwireTriggered: true,        message: &#x27;Production input limit exceeded&#x27;,        severity: &#x27;high&#x27;,      };    }    return { tripwireTriggered: false };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"best-practices\">Best Practices\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#best-practices\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Best Practices”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"1-descriptive-names-and-messages\">1. Descriptive Names and Messages\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#1-descriptive-names-and-messages\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “1. Descriptive Names and Messages”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">goodGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineInputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'pii-email-detector'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">description: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Detects and blocks email addresses in user input'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// ... validation\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Email address detected. Please remove PII before submitting.'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'critical'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: { detectedPattern: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'email'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const goodGuardrail = defineInputGuardrail({  name: &#x27;pii-email-detector&#x27;,  description: &#x27;Detects and blocks email addresses in user input&#x27;,  execute: async (params) => {    // ... validation    return {      tripwireTriggered: true,      message: &#x27;Email address detected. Please remove PII before submitting.&#x27;,      severity: &#x27;critical&#x27;,      metadata: { detectedPattern: &#x27;email&#x27; },    };  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"2-use-appropriate-severity-levels\">2. Use Appropriate Severity Levels\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#2-use-appropriate-severity-levels\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “2. Use Appropriate Severity Levels”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Cstrong>\u003Ccode dir=\"auto\">critical\u003C/code>\u003C/strong>: Security violations, PII leaks, compliance issues\u003C/li>\n\u003Cli>\u003Cstrong>\u003Ccode dir=\"auto\">high\u003C/code>\u003C/strong>: Quality failures, policy violations\u003C/li>\n\u003Cli>\u003Cstrong>\u003Ccode dir=\"auto\">medium\u003C/code>\u003C/strong>: Warning-level issues, soft limits\u003C/li>\n\u003Cli>\u003Cstrong>\u003Ccode dir=\"auto\">low\u003C/code>\u003C/strong>: Minor issues, informational\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"3-include-metadata\">3. Include Metadata\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#3-include-metadata\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “3. Include Metadata”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Rate limit exceeded'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'high'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">metadata: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">userId: params.userId,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">requestCount: currentCount,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">limit: maxRequests,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">resetTime: resetTimestamp,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">};\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"return {  tripwireTriggered: true,  message: &#x27;Rate limit exceeded&#x27;,  severity: &#x27;high&#x27;,  metadata: {    userId: params.userId,    requestCount: currentCount,    limit: maxRequests,    resetTime: resetTimestamp,  },};\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"4-handle-errors-gracefully\">4. Handle Errors Gracefully\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#4-handle-errors-gracefully\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “4. Handle Errors Gracefully”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">guardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">defineInputGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'external-check'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">execute\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">try\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">result\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> externalAPI.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">check\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(params);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> result.isValid\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">?\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, message: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Validation failed'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">catch\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (error) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Log error but don't block user\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">error\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Guardrail error:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, error);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { tripwireTriggered: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }; \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Fail open\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const guardrail = defineInputGuardrail({  name: &#x27;external-check&#x27;,  execute: async (params) => {    try {      const result = await externalAPI.check(params);      return result.isValid        ? { tripwireTriggered: false }        : { tripwireTriggered: true, message: &#x27;Validation failed&#x27; };    } catch (error) {      // Log error but don&#x27;t block user      console.error(&#x27;Guardrail error:&#x27;, error);      return { tripwireTriggered: false }; // Fail open    }  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/reference/built-in-guardrails/\">Built-in Guardrails\u003C/a> - See examples of built-in guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/reference/api/\">API Reference\u003C/a> - Complete guardrail API\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/testing/\">Testing Guardrails\u003C/a> - How to test custom guardrails\u003C/li>\n\u003C/ul>",{"headings":219,"localImagePaths":261,"remoteImagePaths":262,"frontmatter":263,"imagePaths":264},[220,221,224,227,230,231,233,236,239,242,245,248,251,254,257,260],{"depth":59,"slug":133,"text":134},{"depth":81,"slug":222,"text":223},"basic-example","Basic Example",{"depth":81,"slug":225,"text":226},"with-text-extraction","With Text Extraction",{"depth":81,"slug":228,"text":229},"async-validation","Async Validation",{"depth":59,"slug":136,"text":137},{"depth":81,"slug":232,"text":223},"basic-example-1",{"depth":81,"slug":234,"text":235},"with-structured-outputs","With Structured Outputs",{"depth":81,"slug":237,"text":238},"llm-as-judge-pattern","LLM-as-Judge Pattern",{"depth":59,"slug":240,"text":241},"configurable-guardrails","Configurable Guardrails",{"depth":59,"slug":243,"text":244},"conditional-guardrails","Conditional Guardrails",{"depth":59,"slug":246,"text":247},"best-practices","Best Practices",{"depth":81,"slug":249,"text":250},"1-descriptive-names-and-messages","1. Descriptive Names and Messages",{"depth":81,"slug":252,"text":253},"2-use-appropriate-severity-levels","2. Use Appropriate Severity Levels",{"depth":81,"slug":255,"text":256},"3-include-metadata","3. Include Metadata",{"depth":81,"slug":258,"text":259},"4-handle-errors-gracefully","4. Handle Errors Gracefully",{"depth":59,"slug":106,"text":107},[],[],{"title":208,"description":209},[],"guides/custom-guardrails.md","guides/basic-protection",{"id":266,"data":268,"body":274,"filePath":275,"digest":276,"rendered":277,"legacyId":310},{"title":269,"description":270,"editUrl":16,"head":271,"template":48,"sidebar":272,"pagefind":16,"draft":36},"Basic Protection Setup","Get started with essential guardrails for input and output protection",[],{"hidden":36,"attrs":273},{},"This guide shows you how to add basic protection to your AI application using the most common guardrails.\n\n## Input + Output Protection\n\nThe most common setup combines input protection (PII, prompt injection) with output filtering:\n\n```ts\nimport { generateText } from 'ai';\nimport { openai } from '@ai-sdk/openai';\nimport {\n  withGuardrails,\n  piiDetector,\n  promptInjectionDetector,\n  sensitiveDataFilter,\n} from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    piiDetector(),              // Block PII in prompts\n    promptInjectionDetector(),   // Detect injection attempts\n  ],\n  outputGuardrails: [\n    sensitiveDataFilter(),       // Remove secrets from responses\n  ],\n});\n\n// Use exactly like before - nothing else changes\nconst { text } = await generateText({\n  model,\n  prompt: 'Write a friendly email',\n});\n```\n\n## Why These Three?\n\n### 1. PII Detector (Input)\n\nBlocks personally identifiable information before it reaches your model:\n\n- ✅ Prevents compliance violations (GDPR, HIPAA, CCPA)\n- ✅ Saves costs by blocking bad requests\n- ✅ Protects user privacy\n\n**What it detects:**\n- Email addresses\n- Phone numbers\n- Social Security Numbers\n- Credit card numbers\n- IP addresses\n- Postal addresses\n\n### 2. Prompt Injection Detector (Input)\n\nDetects attempts to manipulate the AI:\n\n- ✅ Prevents security vulnerabilities\n- ✅ Blocks jailbreak attempts\n- ✅ Protects against malicious instructions\n\n**What it detects:**\n- Role-playing attacks (\"Ignore previous instructions\")\n- Context switching attempts\n- Delimiter injection\n- Encoded attacks\n\n### 3. Sensitive Data Filter (Output)\n\nRemoves secrets and sensitive data from AI responses:\n\n- ✅ Prevents API key leakage\n- ✅ Blocks password exposure\n- ✅ Removes tokens and secrets\n\n**What it filters:**\n- API keys (AWS, OpenAI, GitHub, etc.)\n- Private keys and certificates\n- OAuth tokens\n- Database credentials\n- Environment variables\n\n## With Error Handling\n\nIn production, handle guardrail violations explicitly:\n\n```ts\nimport { isGuardrailsError } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector(), promptInjectionDetector()],\n  outputGuardrails: [sensitiveDataFilter()],\n  throwOnBlocked: true, // Throw errors instead of silent blocking\n});\n\ntry {\n  const { text } = await generateText({\n    model,\n    prompt: userPrompt,\n  });\n  console.log(text);\n} catch (error) {\n  if (isGuardrailsError(error)) {\n    // Show user-friendly message\n    console.error('Request blocked:', error.message);\n    // error.violations contains details\n  } else {\n    // Handle other errors\n    throw error;\n  }\n}\n```\n\n## With Callbacks\n\nMonitor violations without throwing errors:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n  outputGuardrails: [sensitiveDataFilter()],\n  throwOnBlocked: false,\n  onInputBlocked: (violations) => {\n    // Log to monitoring service\n    console.warn('Input blocked:', violations);\n  },\n  onOutputBlocked: (violations) => {\n    // Log to monitoring service\n    console.warn('Output blocked:', violations);\n  },\n});\n```\n\n## Reusable Configuration\n\nCreate a reusable guardrail configuration:\n\n```ts\nimport { createGuardrails } from 'ai-sdk-guardrails';\n\n// Define once\nconst basicProtection = createGuardrails({\n  inputGuardrails: [piiDetector(), promptInjectionDetector()],\n  outputGuardrails: [sensitiveDataFilter()],\n  throwOnBlocked: true,\n});\n\n// Apply to multiple models\nconst gpt4 = basicProtection(openai('gpt-4o'));\nconst claude = basicProtection(anthropic('claude-3-sonnet'));\nconst llama = basicProtection(ollama('llama3.2'));\n```\n\n## Next Steps\n\n- [Streaming with Guardrails](/guides/streaming/) - Handle streaming responses\n- [Custom Guardrails](/guides/custom-guardrails/) - Create domain-specific rules\n- [Built-in Guardrails Reference](/reference/built-in-guardrails/) - Explore all available guardrails","src/content/docs/guides/basic-protection.md","ce7afa2430b758de",{"html":278,"metadata":279},"\u003Cp>This guide shows you how to add basic protection to your AI application using the most common guardrails.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"input--output-protection\">Input + Output Protection\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#input--output-protection\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input + Output Protection”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>The most common setup combines input protection (PII, prompt injection) with output filtering:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { generateText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">withGuardrails,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">piiDetector,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">promptInjectionDetector,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">sensitiveDataFilter,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),              \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Block PII in prompts\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),   \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Detect injection attempts\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),       \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Remove secrets from responses\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Use exactly like before - nothing else changes\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Write a friendly email'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { generateText } from &#x27;ai&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;import {  withGuardrails,  piiDetector,  promptInjectionDetector,  sensitiveDataFilter,} from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    piiDetector(),              // Block PII in prompts    promptInjectionDetector(),   // Detect injection attempts  ],  outputGuardrails: [    sensitiveDataFilter(),       // Remove secrets from responses  ],});// Use exactly like before - nothing else changesconst { text } = await generateText({  model,  prompt: &#x27;Write a friendly email&#x27;,});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"why-these-three\">Why These Three?\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#why-these-three\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Why These Three?”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"1-pii-detector-input\">1. PII Detector (Input)\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#1-pii-detector-input\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “1. PII Detector (Input)”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Blocks personally identifiable information before it reaches your model:\u003C/p>\n\u003Cul>\n\u003Cli>✅ Prevents compliance violations (GDPR, HIPAA, CCPA)\u003C/li>\n\u003Cli>✅ Saves costs by blocking bad requests\u003C/li>\n\u003Cli>✅ Protects user privacy\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>What it detects:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Email addresses\u003C/li>\n\u003Cli>Phone numbers\u003C/li>\n\u003Cli>Social Security Numbers\u003C/li>\n\u003Cli>Credit card numbers\u003C/li>\n\u003Cli>IP addresses\u003C/li>\n\u003Cli>Postal addresses\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"2-prompt-injection-detector-input\">2. Prompt Injection Detector (Input)\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#2-prompt-injection-detector-input\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “2. Prompt Injection Detector (Input)”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Detects attempts to manipulate the AI:\u003C/p>\n\u003Cul>\n\u003Cli>✅ Prevents security vulnerabilities\u003C/li>\n\u003Cli>✅ Blocks jailbreak attempts\u003C/li>\n\u003Cli>✅ Protects against malicious instructions\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>What it detects:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Role-playing attacks (“Ignore previous instructions”)\u003C/li>\n\u003Cli>Context switching attempts\u003C/li>\n\u003Cli>Delimiter injection\u003C/li>\n\u003Cli>Encoded attacks\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"3-sensitive-data-filter-output\">3. Sensitive Data Filter (Output)\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#3-sensitive-data-filter-output\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “3. Sensitive Data Filter (Output)”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Removes secrets and sensitive data from AI responses:\u003C/p>\n\u003Cul>\n\u003Cli>✅ Prevents API key leakage\u003C/li>\n\u003Cli>✅ Blocks password exposure\u003C/li>\n\u003Cli>✅ Removes tokens and secrets\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>What it filters:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>API keys (AWS, OpenAI, GitHub, etc.)\u003C/li>\n\u003Cli>Private keys and certificates\u003C/li>\n\u003Cli>OAuth tokens\u003C/li>\n\u003Cli>Database credentials\u003C/li>\n\u003Cli>Environment variables\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"with-error-handling\">With Error Handling\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#with-error-handling\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “With Error Handling”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>In production, handle guardrail violations explicitly:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { isGuardrailsError } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(), \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">throwOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Throw errors instead of silent blocking\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">try\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: userPrompt,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">log\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(text);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">catch\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (error) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">isGuardrailsError\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(error)) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Show user-friendly message\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">error\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Request blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, error.message);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// error.violations contains details\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">else\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Handle other errors\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">throw\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> error;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { isGuardrailsError } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector(), promptInjectionDetector()],  outputGuardrails: [sensitiveDataFilter()],  throwOnBlocked: true, // Throw errors instead of silent blocking});try {  const { text } = await generateText({    model,    prompt: userPrompt,  });  console.log(text);} catch (error) {  if (isGuardrailsError(error)) {    // Show user-friendly message    console.error(&#x27;Request blocked:&#x27;, error.message);    // error.violations contains details  } else {    // Handle other errors    throw error;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"with-callbacks\">With Callbacks\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#with-callbacks\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “With Callbacks”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Monitor violations without throwing errors:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">throwOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">onInputBlocked\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">violations\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Log to monitoring service\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">warn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Input blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, violations);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">onOutputBlocked\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">violations\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Log to monitoring service\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">warn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Output blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, violations);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],  outputGuardrails: [sensitiveDataFilter()],  throwOnBlocked: false,  onInputBlocked: (violations) => {    // Log to monitoring service    console.warn(&#x27;Input blocked:&#x27;, violations);  },  onOutputBlocked: (violations) => {    // Log to monitoring service    console.warn(&#x27;Output blocked:&#x27;, violations);  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"reusable-configuration\">Reusable Configuration\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#reusable-configuration\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Reusable Configuration”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Create a reusable guardrail configuration:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { createGuardrails } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Define once\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">basicProtection\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">createGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(), \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">throwOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Apply to multiple models\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">gpt4\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">basicProtection\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">claude\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">basicProtection\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">anthropic\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'claude-3-sonnet'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">llama\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">basicProtection\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">ollama\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'llama3.2'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">));\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { createGuardrails } from &#x27;ai-sdk-guardrails&#x27;;// Define onceconst basicProtection = createGuardrails({  inputGuardrails: [piiDetector(), promptInjectionDetector()],  outputGuardrails: [sensitiveDataFilter()],  throwOnBlocked: true,});// Apply to multiple modelsconst gpt4 = basicProtection(openai(&#x27;gpt-4o&#x27;));const claude = basicProtection(anthropic(&#x27;claude-3-sonnet&#x27;));const llama = basicProtection(ollama(&#x27;llama3.2&#x27;));\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/guides/streaming/\">Streaming with Guardrails\u003C/a> - Handle streaming responses\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/custom-guardrails/\">Custom Guardrails\u003C/a> - Create domain-specific rules\u003C/li>\n\u003Cli>\u003Ca href=\"/reference/built-in-guardrails/\">Built-in Guardrails Reference\u003C/a> - Explore all available guardrails\u003C/li>\n\u003C/ul>",{"headings":280,"localImagePaths":306,"remoteImagePaths":307,"frontmatter":308,"imagePaths":309},[281,284,287,290,293,296,299,302,305],{"depth":59,"slug":282,"text":283},"input--output-protection","Input + Output Protection",{"depth":59,"slug":285,"text":286},"why-these-three","Why These Three?",{"depth":81,"slug":288,"text":289},"1-pii-detector-input","1. PII Detector (Input)",{"depth":81,"slug":291,"text":292},"2-prompt-injection-detector-input","2. Prompt Injection Detector (Input)",{"depth":81,"slug":294,"text":295},"3-sensitive-data-filter-output","3. Sensitive Data Filter (Output)",{"depth":59,"slug":297,"text":298},"with-error-handling","With Error Handling",{"depth":59,"slug":300,"text":301},"with-callbacks","With Callbacks",{"depth":59,"slug":303,"text":304},"reusable-configuration","Reusable Configuration",{"depth":59,"slug":106,"text":107},[],[],{"title":269,"description":270},[],"guides/basic-protection.md","introduction",{"id":311,"data":313,"body":319,"filePath":320,"digest":321,"rendered":322,"legacyId":351},{"title":314,"description":315,"editUrl":16,"head":316,"template":48,"sidebar":317,"pagefind":16,"draft":36},"Introduction","An overview of AI SDK Guardrails",[],{"hidden":36,"attrs":318},{},"AI SDK Guardrails provides safety and quality controls for AI SDK applications. It validates inputs before they reach your model and outputs before they reach users.\n\n## What are Guardrails?\n\nGuardrails are validation functions that check AI inputs and outputs against specific criteria. They can:\n\n- **Block requests**: Prevent inputs with PII or malicious content from reaching the model\n- **Filter responses**: Remove sensitive data or inappropriate content from outputs\n- **Enforce quality**: Require outputs to meet minimum standards\n- **Validate format**: Ensure responses match expected schemas\n\n## Example\n\nWithout guardrails:\n\n```ts\n// User provides PII in their prompt\nconst { text } = await generateText({\n  model: openai('gpt-4o'),\n  prompt: 'My email is john@company.com, help me...',\n});\n// PII sent to model → potential compliance issue\n```\n\nWith guardrails:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n\nconst { text } = await generateText({\n  model,\n  prompt: 'My email is john@company.com, help me...',\n});\n// Request blocked → PII never sent → compliant\n```\n\n## Guardrail Types\n\n### Input Guardrails\n\nRun before the model receives the request. Use these to:\n\n- Detect PII (emails, phone numbers, SSNs)\n- Block prompt injection attempts\n- Filter toxic or inappropriate content\n- Enforce length limits\n- Apply rate limiting\n\n### Output Guardrails\n\nRun after the model generates a response. Use these to:\n\n- Remove sensitive data from responses\n- Enforce minimum quality standards\n- Validate output format\n- Check for hallucinations\n- Filter inappropriate content\n\n### Tool Guardrails\n\nRun during tool execution in agent workflows. Use these to:\n\n- Validate tool parameters\n- Enforce tool allowlists\n- Control tool execution policies\n\n## Integration\n\nAI SDK Guardrails works as middleware for the AI SDK:\n\n```ts\nimport { withGuardrails } from 'ai-sdk-guardrails';\n\n// Wrap any AI SDK model\nconst guardedModel = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [...],\n  outputGuardrails: [...],\n});\n\n// Use it like a normal model\nawait generateText({ model: guardedModel, prompt: '...' });\nawait streamText({ model: guardedModel, prompt: '...' });\n```\n\nYour existing code, telemetry, and logging continue to work unchanged.\n\n## Key Concepts\n\n- **Blocking vs. Warning**: Choose whether guardrails should throw errors or just log warnings\n- **Auto-retry**: Automatically retry when outputs don't meet quality standards\n- **Streaming**: Guardrails work with both `generateText` and `streamText`\n- **Composability**: Mix and match guardrails to fit your requirements\n\n## Next Steps\n\n- [Quick Start](/quick-start/) - Set up guardrails in 5 minutes\n- [Built-in Guardrails](/reference/built-in-guardrails/) - Explore available guardrails\n- [Custom Guardrails](/guides/custom-guardrails/) - Create your own guardrails","src/content/docs/introduction.md","a338ea0cb2f26cde",{"html":323,"metadata":324},"\u003Cp>AI SDK Guardrails provides safety and quality controls for AI SDK applications. It validates inputs before they reach your model and outputs before they reach users.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"what-are-guardrails\">What are Guardrails?\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#what-are-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “What are Guardrails?”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Guardrails are validation functions that check AI inputs and outputs against specific criteria. They can:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Block requests\u003C/strong>: Prevent inputs with PII or malicious content from reaching the model\u003C/li>\n\u003Cli>\u003Cstrong>Filter responses\u003C/strong>: Remove sensitive data or inappropriate content from outputs\u003C/li>\n\u003Cli>\u003Cstrong>Enforce quality\u003C/strong>: Require outputs to meet minimum standards\u003C/li>\n\u003Cli>\u003Cstrong>Validate format\u003C/strong>: Ensure responses match expected schemas\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"example\">Example\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#example\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Example”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Without guardrails:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// User provides PII in their prompt\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model: \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'My email is john@company.com, help me...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// PII sent to model → potential compliance issue\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// User provides PII in their promptconst { text } = await generateText({  model: openai(&#x27;gpt-4o&#x27;),  prompt: &#x27;My email is john@company.com, help me...&#x27;,});// PII sent to model → potential compliance issue\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>With guardrails:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'My email is john@company.com, help me...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Request blocked → PII never sent → compliant\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});const { text } = await generateText({  model,  prompt: &#x27;My email is john@company.com, help me...&#x27;,});// Request blocked → PII never sent → compliant\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"guardrail-types\">Guardrail Types\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#guardrail-types\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Guardrail Types”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"input-guardrails\">Input Guardrails\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#input-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Run before the model receives the request. Use these to:\u003C/p>\n\u003Cul>\n\u003Cli>Detect PII (emails, phone numbers, SSNs)\u003C/li>\n\u003Cli>Block prompt injection attempts\u003C/li>\n\u003Cli>Filter toxic or inappropriate content\u003C/li>\n\u003Cli>Enforce length limits\u003C/li>\n\u003Cli>Apply rate limiting\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"output-guardrails\">Output Guardrails\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#output-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Output Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Run after the model generates a response. Use these to:\u003C/p>\n\u003Cul>\n\u003Cli>Remove sensitive data from responses\u003C/li>\n\u003Cli>Enforce minimum quality standards\u003C/li>\n\u003Cli>Validate output format\u003C/li>\n\u003Cli>Check for hallucinations\u003C/li>\n\u003Cli>Filter inappropriate content\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"tool-guardrails\">Tool Guardrails\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#tool-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Tool Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Run during tool execution in agent workflows. Use these to:\u003C/p>\n\u003Cul>\n\u003Cli>Validate tool parameters\u003C/li>\n\u003Cli>Enforce tool allowlists\u003C/li>\n\u003Cli>Control tool execution policies\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"integration\">Integration\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#integration\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Integration”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>AI SDK Guardrails works as middleware for the AI SDK:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Wrap any AI SDK model\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">guardedModel\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">...\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">...\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Use it like a normal model\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">generateText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ model: guardedModel, prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">streamText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ model: guardedModel, prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> });\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { withGuardrails } from &#x27;ai-sdk-guardrails&#x27;;// Wrap any AI SDK modelconst guardedModel = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [...],  outputGuardrails: [...],});// Use it like a normal modelawait generateText({ model: guardedModel, prompt: &#x27;...&#x27; });await streamText({ model: guardedModel, prompt: &#x27;...&#x27; });\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Your existing code, telemetry, and logging continue to work unchanged.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"key-concepts\">Key Concepts\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#key-concepts\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Key Concepts”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Cstrong>Blocking vs. Warning\u003C/strong>: Choose whether guardrails should throw errors or just log warnings\u003C/li>\n\u003Cli>\u003Cstrong>Auto-retry\u003C/strong>: Automatically retry when outputs don’t meet quality standards\u003C/li>\n\u003Cli>\u003Cstrong>Streaming\u003C/strong>: Guardrails work with both \u003Ccode dir=\"auto\">generateText\u003C/code> and \u003Ccode dir=\"auto\">streamText\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>Composability\u003C/strong>: Mix and match guardrails to fit your requirements\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/quick-start/\">Quick Start\u003C/a> - Set up guardrails in 5 minutes\u003C/li>\n\u003Cli>\u003Ca href=\"/reference/built-in-guardrails/\">Built-in Guardrails\u003C/a> - Explore available guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/custom-guardrails/\">Custom Guardrails\u003C/a> - Create your own guardrails\u003C/li>\n\u003C/ul>",{"headings":325,"localImagePaths":347,"remoteImagePaths":348,"frontmatter":349,"imagePaths":350},[326,329,332,335,336,337,340,343,346],{"depth":59,"slug":327,"text":328},"what-are-guardrails","What are Guardrails?",{"depth":59,"slug":330,"text":331},"example","Example",{"depth":59,"slug":333,"text":334},"guardrail-types","Guardrail Types",{"depth":81,"slug":133,"text":134},{"depth":81,"slug":136,"text":137},{"depth":81,"slug":338,"text":339},"tool-guardrails","Tool Guardrails",{"depth":59,"slug":341,"text":342},"integration","Integration",{"depth":59,"slug":344,"text":345},"key-concepts","Key Concepts",{"depth":59,"slug":106,"text":107},[],[],{"title":314,"description":315},[],"introduction.md","guides/streaming",{"id":352,"data":354,"body":360,"filePath":361,"digest":362,"rendered":363,"legacyId":408},{"title":355,"description":356,"editUrl":16,"head":357,"template":48,"sidebar":358,"pagefind":16,"draft":36},"Streaming with Guardrails","Learn how to use guardrails with streaming responses",[],{"hidden":36,"attrs":359},{},"Guardrails work seamlessly with streaming responses. You can choose when and how guardrails check streamed content.\n\n## Basic Streaming\n\nGuardrails run automatically after the stream completes:\n\n```ts\nimport { streamText } from 'ai';\nimport { withGuardrails, minLengthRequirement } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n});\n\n// Stream works normally - guardrails run after completion\nconst { textStream } = await streamText({\n  model,\n  prompt: 'Explain quantum computing',\n});\n\nfor await (const chunk of textStream) {\n  process.stdout.write(chunk);\n}\n```\n\n## Stream Modes\n\n### Buffer Mode (Default)\n\nWait for the entire stream to complete, then check:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n  streamMode: 'buffer', // Default - waits for completion\n});\n```\n\n**Best for:**\n- Validating complete responses\n- Checking output length\n- Running quality assessments\n- Schema validation\n\n**Trade-off**: User sees entire response before validation\n\n### Progressive Mode\n\nCheck guardrails as tokens arrive (early termination):\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [toxicityFilter()],\n  streamMode: 'progressive', // Check during streaming\n});\n```\n\n**Best for:**\n- Real-time content filtering\n- Early stopping on violations\n- Saving costs (terminate bad generations early)\n- Immediate feedback\n\n**Trade-off**: Some guardrails may not work with partial content\n\n## Handling Blocked Streams\n\n### Replace with Fallback\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n  replaceOnBlocked: true, // Return fallback message\n  blockedMessage: 'The response did not meet quality standards.',\n});\n```\n\n### Throw Errors\n\n```ts\nimport { isGuardrailsError } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [toxicityFilter()],\n  throwOnBlocked: true,\n});\n\ntry {\n  const { textStream } = await streamText({ model, prompt: '...' });\n  for await (const chunk of textStream) {\n    process.stdout.write(chunk);\n  }\n} catch (error) {\n  if (isGuardrailsError(error)) {\n    console.error('Stream blocked:', error.message);\n  }\n}\n```\n\n## Auto-Retry on Quality Issues\n\nAutomatically retry when streaming output doesn't meet requirements:\n\n```ts\nimport { wrapWithOutputGuardrails } from 'ai-sdk-guardrails';\n\nconst model = wrapWithOutputGuardrails(\n  openai('gpt-4o'),\n  [minLengthRequirement(100)],\n  {\n    retry: {\n      maxRetries: 2,\n      buildRetryParams: ({ lastParams }) => ({\n        ...lastParams,\n        maxOutputTokens: (lastParams.maxOutputTokens ?? 400) + 200,\n        prompt: [\n          ...lastParams.prompt,\n          {\n            role: 'user',\n            content: 'Please provide a more detailed response.',\n          },\n        ],\n      }),\n    },\n  },\n);\n\nconst { textStream } = await streamText({ model, prompt: '...' });\n// Automatically retries if output is too short\n```\n\n## Stream Transform Stopping\n\nFor more control, use stream transformers:\n\n```ts\nimport { experimental_streamTransformStop } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    experimental_streamTransformStop({\n      stopCondition: (text) => text.includes('[STOP]'),\n      removeStopMarker: true,\n    }),\n  ],\n});\n\n// Stops streaming when \"[STOP]\" is detected\n```\n\n## Monitoring Stream Violations\n\nTrack violations during streaming:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [toxicityFilter()],\n  onOutputBlocked: (violations) => {\n    // Log to monitoring service\n    violations.forEach((v) => {\n      console.log('Blocked:', v.guardrailName, v.message);\n    });\n  },\n});\n```\n\n## Best Practices\n\n### 1. Choose the Right Mode\n\n- Use **buffer mode** for quality checks (length, schema, structure)\n- Use **progressive mode** for safety checks (toxicity, PII in responses)\n\n### 2. Handle Failures Gracefully\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n  replaceOnBlocked: true,\n  blockedMessage: 'Response did not meet quality standards. Please try again.',\n  onOutputBlocked: async (violations) => {\n    // Log to monitoring\n    await logToMonitoring({ violations, timestamp: Date.now() });\n  },\n});\n```\n\n### 3. Set Appropriate Timeouts\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [minLengthRequirement(100)],\n  streamMode: 'progressive',\n  timeout: 30000, // 30 second timeout\n});\n```\n\n## Next Steps\n\n- [Custom Guardrails](/guides/custom-guardrails/) - Create streaming-aware guardrails\n- [Stopping Mechanisms](/guides/stopping-mechanisms/) - Stopping strategies\n- [API Reference](/reference/api/) - Complete configuration options","src/content/docs/guides/streaming.md","76f63931ef379a52",{"html":364,"metadata":365},"\u003Cp>Guardrails work seamlessly with streaming responses. You can choose when and how guardrails check streamed content.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"basic-streaming\">Basic Streaming\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#basic-streaming\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Basic Streaming”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Guardrails run automatically after the stream completes:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { streamText } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { withGuardrails, minLengthRequirement } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Stream works normally - guardrails run after completion\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">textStream\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">streamText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">model,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Explain quantum computing'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">for\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">chunk\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">of\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> textStream) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">process.stdout.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">write\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(chunk);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { streamText } from &#x27;ai&#x27;;import { withGuardrails, minLengthRequirement } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],});// Stream works normally - guardrails run after completionconst { textStream } = await streamText({  model,  prompt: &#x27;Explain quantum computing&#x27;,});for await (const chunk of textStream) {  process.stdout.write(chunk);}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"stream-modes\">Stream Modes\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#stream-modes\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Stream Modes”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"buffer-mode-default\">Buffer Mode (Default)\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#buffer-mode-default\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Buffer Mode (Default)”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Wait for the entire stream to complete, then check:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">streamMode: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'buffer'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Default - waits for completion\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],  streamMode: &#x27;buffer&#x27;, // Default - waits for completion});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Best for:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Validating complete responses\u003C/li>\n\u003Cli>Checking output length\u003C/li>\n\u003Cli>Running quality assessments\u003C/li>\n\u003Cli>Schema validation\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Trade-off\u003C/strong>: User sees entire response before validation\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"progressive-mode\">Progressive Mode\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#progressive-mode\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Progressive Mode”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Check guardrails as tokens arrive (early termination):\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">streamMode: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'progressive'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Check during streaming\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [toxicityFilter()],  streamMode: &#x27;progressive&#x27;, // Check during streaming});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Best for:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Real-time content filtering\u003C/li>\n\u003Cli>Early stopping on violations\u003C/li>\n\u003Cli>Saving costs (terminate bad generations early)\u003C/li>\n\u003Cli>Immediate feedback\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Trade-off\u003C/strong>: Some guardrails may not work with partial content\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"handling-blocked-streams\">Handling Blocked Streams\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#handling-blocked-streams\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Handling Blocked Streams”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"replace-with-fallback\">Replace with Fallback\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#replace-with-fallback\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Replace with Fallback”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">replaceOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Return fallback message\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">blockedMessage: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'The response did not meet quality standards.'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],  replaceOnBlocked: true, // Return fallback message  blockedMessage: &#x27;The response did not meet quality standards.&#x27;,});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"throw-errors\">Throw Errors\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#throw-errors\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Throw Errors”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { isGuardrailsError } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">throwOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">try\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">textStream\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">streamText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ model, prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">for\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">chunk\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">of\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> textStream) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">process.stdout.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">write\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(chunk);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">catch\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (error) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">isGuardrailsError\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(error)) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">error\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Stream blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, error.message);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { isGuardrailsError } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [toxicityFilter()],  throwOnBlocked: true,});try {  const { textStream } = await streamText({ model, prompt: &#x27;...&#x27; });  for await (const chunk of textStream) {    process.stdout.write(chunk);  }} catch (error) {  if (isGuardrailsError(error)) {    console.error(&#x27;Stream blocked:&#x27;, error.message);  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"auto-retry-on-quality-issues\">Auto-Retry on Quality Issues\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#auto-retry-on-quality-issues\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Auto-Retry on Quality Issues”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Automatically retry when streaming output doesn’t meet requirements:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { wrapWithOutputGuardrails } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">wrapWithOutputGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">[\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">retry: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxRetries: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">2\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">buildRetryParams\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: ({ \u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">lastParams\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> ({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">...\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">lastParams,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxOutputTokens: (lastParams.maxOutputTokens \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">??\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">400\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">+\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">200\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">prompt: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">...\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">lastParams.prompt,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">role: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'user'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">content: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Please provide a more detailed response.'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">textStream\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">streamText\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ model, prompt: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'...'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Automatically retries if output is too short\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { wrapWithOutputGuardrails } from &#x27;ai-sdk-guardrails&#x27;;const model = wrapWithOutputGuardrails(  openai(&#x27;gpt-4o&#x27;),  [minLengthRequirement(100)],  {    retry: {      maxRetries: 2,      buildRetryParams: ({ lastParams }) => ({        ...lastParams,        maxOutputTokens: (lastParams.maxOutputTokens ?? 400) + 200,        prompt: [          ...lastParams.prompt,          {            role: &#x27;user&#x27;,            content: &#x27;Please provide a more detailed response.&#x27;,          },        ],      }),    },  },);const { textStream } = await streamText({ model, prompt: &#x27;...&#x27; });// Automatically retries if output is too short\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"stream-transform-stopping\">Stream Transform Stopping\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#stream-transform-stopping\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Stream Transform Stopping”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>For more control, use stream transformers:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { experimental_streamTransformStop } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">experimental_streamTransformStop\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">stopCondition\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">text\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> text.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">includes\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'[STOP]'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">removeStopMarker: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Stops streaming when \"[STOP]\" is detected\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { experimental_streamTransformStop } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    experimental_streamTransformStop({      stopCondition: (text) => text.includes(&#x27;[STOP]&#x27;),      removeStopMarker: true,    }),  ],});// Stops streaming when &#x22;[STOP]&#x22; is detected\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"monitoring-stream-violations\">Monitoring Stream Violations\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#monitoring-stream-violations\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Monitoring Stream Violations”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Track violations during streaming:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">onOutputBlocked\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">violations\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Log to monitoring service\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">violations.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">forEach\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">((\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">v\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">console.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">log\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Blocked:'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, v.guardrailName, v.message);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [toxicityFilter()],  onOutputBlocked: (violations) => {    // Log to monitoring service    violations.forEach((v) => {      console.log(&#x27;Blocked:&#x27;, v.guardrailName, v.message);    });  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"best-practices\">Best Practices\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#best-practices\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Best Practices”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"1-choose-the-right-mode\">1. Choose the Right Mode\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#1-choose-the-right-mode\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “1. Choose the Right Mode”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>Use \u003Cstrong>buffer mode\u003C/strong> for quality checks (length, schema, structure)\u003C/li>\n\u003Cli>Use \u003Cstrong>progressive mode\u003C/strong> for safety checks (toxicity, PII in responses)\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"2-handle-failures-gracefully\">2. Handle Failures Gracefully\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#2-handle-failures-gracefully\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “2. Handle Failures Gracefully”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">replaceOnBlocked: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">blockedMessage: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Response did not meet quality standards. Please try again.'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">onOutputBlocked\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">async\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">violations\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Log to monitoring\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">logToMonitoring\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ violations, timestamp: Date.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">now\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">() });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],  replaceOnBlocked: true,  blockedMessage: &#x27;Response did not meet quality standards. Please try again.&#x27;,  onOutputBlocked: async (violations) => {    // Log to monitoring    await logToMonitoring({ violations, timestamp: Date.now() });  },});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"3-set-appropriate-timeouts\">3. Set Appropriate Timeouts\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#3-set-appropriate-timeouts\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “3. Set Appropriate Timeouts”\u003C/span>\u003C/a>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">streamMode: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'progressive'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">timeout: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">30000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 30 second timeout\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [minLengthRequirement(100)],  streamMode: &#x27;progressive&#x27;,  timeout: 30000, // 30 second timeout});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/guides/custom-guardrails/\">Custom Guardrails\u003C/a> - Create streaming-aware guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/guides/stopping-mechanisms/\">Stopping Mechanisms\u003C/a> - Stopping strategies\u003C/li>\n\u003Cli>\u003Ca href=\"/reference/api/\">API Reference\u003C/a> - Complete configuration options\u003C/li>\n\u003C/ul>",{"headings":366,"localImagePaths":404,"remoteImagePaths":405,"frontmatter":406,"imagePaths":407},[367,370,373,374,375,378,381,384,387,390,393,394,397,400,403],{"depth":59,"slug":368,"text":369},"basic-streaming","Basic Streaming",{"depth":59,"slug":371,"text":372},"stream-modes","Stream Modes",{"depth":81,"slug":189,"text":190},{"depth":81,"slug":192,"text":193},{"depth":59,"slug":376,"text":377},"handling-blocked-streams","Handling Blocked Streams",{"depth":81,"slug":379,"text":380},"replace-with-fallback","Replace with Fallback",{"depth":81,"slug":382,"text":383},"throw-errors","Throw Errors",{"depth":59,"slug":385,"text":386},"auto-retry-on-quality-issues","Auto-Retry on Quality Issues",{"depth":59,"slug":388,"text":389},"stream-transform-stopping","Stream Transform Stopping",{"depth":59,"slug":391,"text":392},"monitoring-stream-violations","Monitoring Stream Violations",{"depth":59,"slug":246,"text":247},{"depth":81,"slug":395,"text":396},"1-choose-the-right-mode","1. Choose the Right Mode",{"depth":81,"slug":398,"text":399},"2-handle-failures-gracefully","2. Handle Failures Gracefully",{"depth":81,"slug":401,"text":402},"3-set-appropriate-timeouts","3. Set Appropriate Timeouts",{"depth":59,"slug":106,"text":107},[],[],{"title":355,"description":356},[],"guides/streaming.md","guides/openai-configs",{"id":409,"data":411,"body":417,"filePath":418,"digest":419,"rendered":420,"legacyId":440},{"title":412,"description":413,"editUrl":16,"head":414,"template":48,"sidebar":415,"pagefind":16,"draft":36},"OpenAI Guardrails Configs","Use guardrails_config.json exports from guardrails.openai.com directly with AI SDK Guardrails.",[],{"hidden":36,"attrs":416},{},"AI SDK Guardrails now uses the same configuration schema as [OpenAI Guardrails](https://guardrails.openai.com). That means the `@guardrails_config (1).json` file that the wizard generates can run unchanged inside your AI SDK apps – no manual translation or YAML editing required.\n\nThis guide shows how to:\n\n1. Load a config exported from the OpenAI wizard.\n2. Execute those guardrails at any pipeline stage.\n3. Convert the config into the familiar `withGuardrails()` shape so you can mix in AI SDK–specific guardrails.\n\n## 1. Export a config\n\nCreate or adjust a pipeline at https://guardrails.openai.com, then click **Download config** to get a `guardrails_config.json` file. The file has the structure:\n\n```jsonc\n{\n  \"version\": 1,\n  \"pre_flight\": {\n    \"version\": 1,\n    \"guardrails\": [{ \"name\": \"Contains PII\", \"config\": { \"entities\": [\"EMAIL_ADDRESS\"] } }]\n  },\n  \"input\": {\n    \"version\": 1,\n    \"guardrails\": [{ \"name\": \"Prompt Injection Detection\", \"config\": { \"confidence_threshold\": 0.65 } }]\n  },\n  \"output\": {\n    \"version\": 1,\n    \"guardrails\": [{ \"name\": \"Moderation\", \"config\": { \"categories\": [\"hate\", \"violence\"] } }]\n  }\n}\n```\n\nAll guardrail names (Contains PII, Prompt Injection Detection, URL Filter, etc.) are registered inside `ai-sdk-guardrails`, so you can reference them verbatim.\n\n## 2. Load and run stages directly\n\nUse the runtime helpers to load and execute guardrails exactly the way OpenAI clients do:\n\n```ts\nimport {\n  loadPipelineConfig,\n  runStageGuardrails,\n  runGuardrails,\n} from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\n\n// Load from file path, JSON string, or object literal\nconst pipeline = await loadPipelineConfig('./guardrails_config.json');\n\n// Run pre-flight/input guardrails before calling the model\nconst preflight = await runStageGuardrails(\n  userPrompt,\n  pipeline,\n  'input',\n  {\n    llm: openai('gpt-4o-mini'), // Required for LLM-powered guardrails\n    requestId: 'req_123',\n    userId: session.user.id,\n  },\n);\n\nif (preflight?.blocked) {\n  // Inspect individual results or surface a friendly error\n  return Response.json({ error: 'Message blocked', details: preflight.results });\n}\n\n// After you get a completion, run the output stage:\nconst output = await runStageGuardrails(\n  completionText,\n  pipeline,\n  'output',\n  { llm: openai('gpt-4o-mini') },\n);\n```\n\nNeed a lower-level primitive? `runGuardrails()` accepts any `GuardrailBundle`, so you can execute just the `pipeline.output` block or even the `guardrails` array itself.\n\n```ts\nawait runGuardrails(responseText, pipeline.output!, { llm: openai('gpt-4o-mini') });\n```\n\n## 3. Wrap AI SDK models with wizard configs\n\nPrefer the ergonomic `withGuardrails()` middleware? Convert the OpenAI schema into AI SDK's format with the provided mapper and keep stacking your own guardrails on top:\n\n```ts\nimport {\n  withGuardrails,\n  mapOpenAIConfigToGuardrails,\n  loadPipelineConfig,\n  sensitiveDataFilter,\n} from 'ai-sdk-guardrails';\nimport { openai } from '@ai-sdk/openai';\n\nconst openAIConfig = await loadPipelineConfig('./guardrails_config.json');\nconst guardrailsFromWizard = mapOpenAIConfigToGuardrails(openAIConfig);\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  ...guardrailsFromWizard,\n  outputGuardrails: [\n    ...(guardrailsFromWizard.outputGuardrails ?? []),\n    sensitiveDataFilter(), // Extend with AI SDK–specific guardrails\n  ],\n});\n```\n\nThis gives you the exact same enforcement as the OpenAI Guardrails client, plus the ability to mix in AI SDK Guardrails features such as:\n\n- Streaming-aware guardrails, retries, and stop conditions\n- Tool guardrails and MCP security layers\n- Custom guardrails built with `defineInputGuardrail` / `defineOutputGuardrail`\n\n## Tips\n\n- **Context matters**: Guardrails like Prompt Injection Detection or Jailbreak checks need an `llm` inside the context so they can call an LLM. Pass your AI SDK model (e.g., `openai('gpt-4o-mini')`) when running stages.\n- **File vs string**: `loadPipelineConfig()` detects file paths automatically. Passing a JSON string or object works the same way for configs stored in a database.\n- **Validation**: Use `validatePipelineConfig()` to show friendly errors when users upload configs with typos or unsupported guardrails.\n- **Partial execution**: You can run only the pre-flight stage for filtering before you invoke other guardrails, or run `pipeline.output` asynchronously after streaming completes.\n\nThe bottom line: if a guardrail works in the OpenAI wizard, it now works in AI SDK Guardrails—with the option to extend it using all of the additional guardrails and automations in this library.","src/content/docs/guides/openai-configs.md","61ba444079c1971d",{"html":421,"metadata":422},"\u003Cp>AI SDK Guardrails now uses the same configuration schema as \u003Ca href=\"https://guardrails.openai.com\">OpenAI Guardrails\u003C/a>. That means the \u003Ccode dir=\"auto\">@guardrails_config (1).json\u003C/code> file that the wizard generates can run unchanged inside your AI SDK apps – no manual translation or YAML editing required.\u003C/p>\n\u003Cp>This guide shows how to:\u003C/p>\n\u003Col>\n\u003Cli>Load a config exported from the OpenAI wizard.\u003C/li>\n\u003Cli>Execute those guardrails at any pipeline stage.\u003C/li>\n\u003Cli>Convert the config into the familiar \u003Ccode dir=\"auto\">withGuardrails()\u003C/code> shape so you can mix in AI SDK–specific guardrails.\u003C/li>\n\u003C/ol>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"1-export-a-config\">1. Export a config\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#1-export-a-config\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “1. Export a config”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Create or adjust a pipeline at \u003Ca href=\"https://guardrails.openai.com\">https://guardrails.openai.com\u003C/a>, then click \u003Cstrong>Download config\u003C/strong> to get a \u003Ccode dir=\"auto\">guardrails_config.json\u003C/code> file. The file has the structure:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"jsonc\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"version\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"pre_flight\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"version\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"guardrails\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: [{ \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"name\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"Contains PII\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"config\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"entities\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"EMAIL_ADDRESS\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">] } }]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"input\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"version\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"guardrails\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: [{ \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"name\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"Prompt Injection Detection\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"config\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"confidence_threshold\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0.65\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> } }]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"output\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"version\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"guardrails\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: [{ \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"name\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"Moderation\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"config\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: { \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">\"categories\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"hate\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"violence\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">] } }]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;version&#x22;: 1,  &#x22;pre_flight&#x22;: {    &#x22;version&#x22;: 1,    &#x22;guardrails&#x22;: [{ &#x22;name&#x22;: &#x22;Contains PII&#x22;, &#x22;config&#x22;: { &#x22;entities&#x22;: [&#x22;EMAIL_ADDRESS&#x22;] } }]  },  &#x22;input&#x22;: {    &#x22;version&#x22;: 1,    &#x22;guardrails&#x22;: [{ &#x22;name&#x22;: &#x22;Prompt Injection Detection&#x22;, &#x22;config&#x22;: { &#x22;confidence_threshold&#x22;: 0.65 } }]  },  &#x22;output&#x22;: {    &#x22;version&#x22;: 1,    &#x22;guardrails&#x22;: [{ &#x22;name&#x22;: &#x22;Moderation&#x22;, &#x22;config&#x22;: { &#x22;categories&#x22;: [&#x22;hate&#x22;, &#x22;violence&#x22;] } }]  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>All guardrail names (Contains PII, Prompt Injection Detection, URL Filter, etc.) are registered inside \u003Ccode dir=\"auto\">ai-sdk-guardrails\u003C/code>, so you can reference them verbatim.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"2-load-and-run-stages-directly\">2. Load and run stages directly\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#2-load-and-run-stages-directly\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “2. Load and run stages directly”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Use the runtime helpers to load and execute guardrails exactly the way OpenAI clients do:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">loadPipelineConfig,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">runStageGuardrails,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">runGuardrails,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Load from file path, JSON string, or object literal\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">pipeline\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">loadPipelineConfig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'./guardrails_config.json'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Run pre-flight/input guardrails before calling the model\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">preflight\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">runStageGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">userPrompt,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">pipeline,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'input'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">llm: \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o-mini'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Required for LLM-powered guardrails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">requestId: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'req_123'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">userId: session.user.id,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">if\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> (preflight?.blocked) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Inspect individual results or surface a friendly error\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">return\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> Response.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">json\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ error: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'Message blocked'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, details: preflight.results });\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// After you get a completion, run the output stage:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">output\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">runStageGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">completionText,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">pipeline,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'output'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">{ llm: \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o-mini'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import {  loadPipelineConfig,  runStageGuardrails,  runGuardrails,} from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;// Load from file path, JSON string, or object literalconst pipeline = await loadPipelineConfig(&#x27;./guardrails_config.json&#x27;);// Run pre-flight/input guardrails before calling the modelconst preflight = await runStageGuardrails(  userPrompt,  pipeline,  &#x27;input&#x27;,  {    llm: openai(&#x27;gpt-4o-mini&#x27;), // Required for LLM-powered guardrails    requestId: &#x27;req_123&#x27;,    userId: session.user.id,  },);if (preflight?.blocked) {  // Inspect individual results or surface a friendly error  return Response.json({ error: &#x27;Message blocked&#x27;, details: preflight.results });}// After you get a completion, run the output stage:const output = await runStageGuardrails(  completionText,  pipeline,  &#x27;output&#x27;,  { llm: openai(&#x27;gpt-4o-mini&#x27;) },);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Need a lower-level primitive? \u003Ccode dir=\"auto\">runGuardrails()\u003C/code> accepts any \u003Ccode dir=\"auto\">GuardrailBundle\u003C/code>, so you can execute just the \u003Ccode dir=\"auto\">pipeline.output\u003C/code> block or even the \u003Ccode dir=\"auto\">guardrails\u003C/code> array itself.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">runGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(responseText, pipeline.output\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, { llm: \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o-mini'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) });\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"await runGuardrails(responseText, pipeline.output!, { llm: openai(&#x27;gpt-4o-mini&#x27;) });\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"3-wrap-ai-sdk-models-with-wizard-configs\">3. Wrap AI SDK models with wizard configs\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#3-wrap-ai-sdk-models-with-wizard-configs\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “3. Wrap AI SDK models with wizard configs”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Prefer the ergonomic \u003Ccode dir=\"auto\">withGuardrails()\u003C/code> middleware? Convert the OpenAI schema into AI SDK’s format with the provided mapper and keep stacking your own guardrails on top:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">withGuardrails,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">mapOpenAIConfigToGuardrails,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">loadPipelineConfig,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">sensitiveDataFilter,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">} \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { openai } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'@ai-sdk/openai'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">openAIConfig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">await\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">loadPipelineConfig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'./guardrails_config.json'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">guardrailsFromWizard\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">mapOpenAIConfigToGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(openAIConfig);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">...\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">guardrailsFromWizard,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">...\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(guardrailsFromWizard.outputGuardrails \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">??\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> []),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Extend with AI SDK–specific guardrails\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import {  withGuardrails,  mapOpenAIConfigToGuardrails,  loadPipelineConfig,  sensitiveDataFilter,} from &#x27;ai-sdk-guardrails&#x27;;import { openai } from &#x27;@ai-sdk/openai&#x27;;const openAIConfig = await loadPipelineConfig(&#x27;./guardrails_config.json&#x27;);const guardrailsFromWizard = mapOpenAIConfigToGuardrails(openAIConfig);const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  ...guardrailsFromWizard,  outputGuardrails: [    ...(guardrailsFromWizard.outputGuardrails ?? []),    sensitiveDataFilter(), // Extend with AI SDK–specific guardrails  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This gives you the exact same enforcement as the OpenAI Guardrails client, plus the ability to mix in AI SDK Guardrails features such as:\u003C/p>\n\u003Cul>\n\u003Cli>Streaming-aware guardrails, retries, and stop conditions\u003C/li>\n\u003Cli>Tool guardrails and MCP security layers\u003C/li>\n\u003Cli>Custom guardrails built with \u003Ccode dir=\"auto\">defineInputGuardrail\u003C/code> / \u003Ccode dir=\"auto\">defineOutputGuardrail\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"tips\">Tips\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#tips\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Tips”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Cstrong>Context matters\u003C/strong>: Guardrails like Prompt Injection Detection or Jailbreak checks need an \u003Ccode dir=\"auto\">llm\u003C/code> inside the context so they can call an LLM. Pass your AI SDK model (e.g., \u003Ccode dir=\"auto\">openai('gpt-4o-mini')\u003C/code>) when running stages.\u003C/li>\n\u003Cli>\u003Cstrong>File vs string\u003C/strong>: \u003Ccode dir=\"auto\">loadPipelineConfig()\u003C/code> detects file paths automatically. Passing a JSON string or object works the same way for configs stored in a database.\u003C/li>\n\u003Cli>\u003Cstrong>Validation\u003C/strong>: Use \u003Ccode dir=\"auto\">validatePipelineConfig()\u003C/code> to show friendly errors when users upload configs with typos or unsupported guardrails.\u003C/li>\n\u003Cli>\u003Cstrong>Partial execution\u003C/strong>: You can run only the pre-flight stage for filtering before you invoke other guardrails, or run \u003Ccode dir=\"auto\">pipeline.output\u003C/code> asynchronously after streaming completes.\u003C/li>\n\u003C/ul>\n\u003Cp>The bottom line: if a guardrail works in the OpenAI wizard, it now works in AI SDK Guardrails—with the option to extend it using all of the additional guardrails and automations in this library.\u003C/p>",{"headings":423,"localImagePaths":436,"remoteImagePaths":437,"frontmatter":438,"imagePaths":439},[424,427,430,433],{"depth":59,"slug":425,"text":426},"1-export-a-config","1. Export a config",{"depth":59,"slug":428,"text":429},"2-load-and-run-stages-directly","2. Load and run stages directly",{"depth":59,"slug":431,"text":432},"3-wrap-ai-sdk-models-with-wizard-configs","3. Wrap AI SDK models with wizard configs",{"depth":59,"slug":434,"text":435},"tips","Tips",[],[],{"title":412,"description":413},[],"guides/openai-configs.md","reference/built-in-guardrails",{"id":441,"data":443,"body":449,"filePath":450,"digest":451,"rendered":452,"legacyId":524},{"title":444,"description":445,"editUrl":16,"head":446,"template":48,"sidebar":447,"pagefind":16,"draft":36},"Built-in Guardrails","Complete reference of all built-in guardrails",[],{"hidden":36,"attrs":448},{},"AI SDK Guardrails provides 30+ guardrails for common use cases.\n\n## Input Guardrails\n\nInput guardrails run **before** the AI model is called, blocking bad requests and saving costs.\n\n### PII Detector\n\nBlock personally identifiable information:\n\n```ts\nimport { piiDetector } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [piiDetector()],\n});\n```\n\n**Detects:**\n- Email addresses\n- Phone numbers\n- Social Security Numbers\n- Credit card numbers\n- IP addresses\n- Postal addresses\n\n**Use cases:** Compliance (GDPR, HIPAA, CCPA), privacy protection\n\n### Prompt Injection Detector\n\nDetect attempts to manipulate the AI:\n\n```ts\nimport { promptInjectionDetector } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [promptInjectionDetector()],\n});\n```\n\n**Detects:**\n- Role-playing attacks (\"Ignore previous instructions\")\n- Context switching attempts\n- Delimiter injection\n- Encoded attacks\n\n**Use cases:** Security, jailbreak prevention\n\n### Blocked Keywords\n\nBlock specific terms or phrases:\n\n```ts\nimport { blockedKeywords } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    blockedKeywords({\n      keywords: ['spam', 'scam', 'phishing'],\n      caseSensitive: false,\n    }),\n  ],\n});\n```\n\n**Use cases:** Content policy enforcement, brand safety\n\n### Input Length Limit\n\nEnforce maximum input length:\n\n```ts\nimport { inputLengthLimit } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    inputLengthLimit({\n      maxLength: 1000,\n      unit: 'characters', // or 'tokens'\n    }),\n  ],\n});\n```\n\n**Use cases:** Cost control, DoS prevention\n\n### Rate Limiting\n\nPer-user or global rate limits:\n\n```ts\nimport { rateLimiting } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    rateLimiting({\n      maxRequests: 10,\n      windowMs: 60000, // 10 requests per minute\n      keyExtractor: (params) => params.userId,\n    }),\n  ],\n});\n```\n\n**Use cases:** Abuse prevention, fair usage\n\n### Profanity Filter\n\nBlock offensive language:\n\n```ts\nimport { profanityFilter } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    profanityFilter({\n      severity: 'medium', // 'low', 'medium', 'high'\n    }),\n  ],\n});\n```\n\n**Use cases:** Content moderation, family-friendly apps\n\n### Toxicity Detector\n\nDetect toxic or harmful content:\n\n```ts\nimport { toxicityDetector } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    toxicityDetector({\n      threshold: 0.7, // 0-1, lower = stricter\n    }),\n  ],\n});\n```\n\n**Use cases:** Safety, harassment prevention\n\n### Allowed Tools Guardrail\n\nRestrict which tools can be used:\n\n```ts\nimport { allowedToolsGuardrail } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    allowedToolsGuardrail({\n      allowedTools: ['search', 'calculator'],\n    }),\n  ],\n});\n```\n\n**Use cases:** Tool security, controlled execution\n\n## Output Guardrails\n\nOutput guardrails run **after** the AI model responds, ensuring quality and safety.\n\n### Sensitive Data Filter\n\nRemove secrets and API keys:\n\n```ts\nimport { sensitiveDataFilter } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [sensitiveDataFilter()],\n});\n```\n\n**Filters:**\n- API keys (AWS, OpenAI, GitHub, etc.)\n- Private keys and certificates\n- OAuth tokens\n- Database credentials\n- Environment variables\n\n**Use cases:** Security, preventing leaks\n\n### Min Length Requirement\n\nEnforce minimum response length:\n\n```ts\nimport { minLengthRequirement } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    minLengthRequirement(100), // 100 characters minimum\n  ],\n});\n```\n\n**Use cases:** Quality control, ensuring completeness\n\n### Output Length Limit\n\nEnforce maximum response length:\n\n```ts\nimport { outputLengthLimit } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    outputLengthLimit({\n      maxLength: 500,\n      unit: 'characters', // or 'tokens'\n    }),\n  ],\n});\n```\n\n**Use cases:** Cost control, UX constraints\n\n### Toxicity Filter\n\nBlock toxic responses:\n\n```ts\nimport { toxicityFilter } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    toxicityFilter({\n      threshold: 0.7,\n    }),\n  ],\n});\n```\n\n**Use cases:** Safety, preventing harmful outputs\n\n### JSON Validation\n\nValidate JSON structure:\n\n```ts\nimport { jsonValidation } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    jsonValidation({\n      strict: true, // Require valid JSON\n    }),\n  ],\n});\n```\n\n**Use cases:** Structured output, API integration\n\n### Schema Validation\n\nValidate against Zod schema:\n\n```ts\nimport { schemaValidation } from 'ai-sdk-guardrails';\nimport { z } from 'zod';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    schemaValidation({\n      schema: z.object({\n        name: z.string(),\n        age: z.number(),\n      }),\n    }),\n  ],\n});\n```\n\n**Use cases:** Type safety, data validation\n\n### Confidence Threshold\n\nRequire minimum confidence:\n\n```ts\nimport { confidenceThreshold } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    confidenceThreshold({\n      minConfidence: 0.8,\n    }),\n  ],\n});\n```\n\n**Use cases:** Quality assurance, uncertain responses\n\n### Hallucination Detector\n\nDetect uncertain or unsupported claims:\n\n```ts\nimport { hallucinationDetector } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    hallucinationDetector({\n      sensitivity: 'medium', // 'low', 'medium', 'high'\n    }),\n  ],\n});\n```\n\n**Use cases:** Accuracy, factual correctness\n\n### Secret Redaction\n\nRedact secrets from output:\n\n```ts\nimport { secretRedaction } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    secretRedaction({\n      redactWith: '[REDACTED]',\n    }),\n  ],\n});\n```\n\n**Use cases:** Security, preventing accidental leaks\n\n## MCP Security Guardrails\n\nSpecialized guardrails for Model Context Protocol (MCP) tools.\n\n### MCP Security Guardrail\n\nMCP security:\n\n```ts\nimport { mcpSecurityGuardrail } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    mcpSecurityGuardrail({\n      detectExfiltration: true,\n      scanEncodedContent: true,\n      allowedDomains: ['api.company.com'],\n      maxContentSize: 51200, // 50KB\n      injectionThreshold: 0.7,\n    }),\n  ],\n});\n```\n\n**Prevents:**\n- Direct prompt injection\n- Tool response poisoning\n- Data exfiltration via URLs\n- Encoded attacks (base64/hex)\n- Cascading exploits\n- Context poisoning\n\n### MCP Response Sanitizer\n\nClean malicious content:\n\n```ts\nimport { mcpResponseSanitizer } from 'ai-sdk-guardrails';\n\nconst model = withGuardrails(openai('gpt-4o'), {\n  outputGuardrails: [\n    mcpResponseSanitizer({\n      removeUrls: true,\n      sanitizeJson: true,\n    }),\n  ],\n});\n```\n\n**Use cases:** Non-blocking security, content cleaning\n\n## Combining Guardrails\n\nMix and match guardrails for protection:\n\n```ts\nconst model = withGuardrails(openai('gpt-4o'), {\n  inputGuardrails: [\n    piiDetector(),\n    promptInjectionDetector(),\n    inputLengthLimit({ maxLength: 1000 }),\n    rateLimiting({ maxRequests: 10, windowMs: 60000 }),\n  ],\n  outputGuardrails: [\n    sensitiveDataFilter(),\n    minLengthRequirement(100),\n    toxicityFilter({ threshold: 0.7 }),\n    schemaValidation({ schema: mySchema }),\n  ],\n});\n```\n\n## Next Steps\n\n- [Custom Guardrails](/guides/custom-guardrails/) - Create your own guardrails\n- [API Reference](/reference/api/) - Complete API documentation\n- [Examples](/examples/) - See guardrails in action","src/content/docs/reference/built-in-guardrails.md","13627676468ba858",{"html":453,"metadata":454},"\u003Cp>AI SDK Guardrails provides 30+ guardrails for common use cases.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"input-guardrails\">Input Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#input-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Input guardrails run \u003Cstrong>before\u003C/strong> the AI model is called, blocking bad requests and saving costs.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"pii-detector\">PII Detector\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#pii-detector\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “PII Detector”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Block personally identifiable information:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/ai-sdk-guardrails/_astro/ec.8agls.css\">\u003Cscript type=\"module\" src=\"/ai-sdk-guardrails/_astro/ec.p1z7b.js\">\u003C/script>\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { piiDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { piiDetector } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [piiDetector()],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Detects:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Email addresses\u003C/li>\n\u003Cli>Phone numbers\u003C/li>\n\u003Cli>Social Security Numbers\u003C/li>\n\u003Cli>Credit card numbers\u003C/li>\n\u003Cli>IP addresses\u003C/li>\n\u003Cli>Postal addresses\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Compliance (GDPR, HIPAA, CCPA), privacy protection\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"prompt-injection-detector\">Prompt Injection Detector\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#prompt-injection-detector\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Prompt Injection Detector”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Detect attempts to manipulate the AI:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { promptInjectionDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { promptInjectionDetector } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [promptInjectionDetector()],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Detects:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Role-playing attacks (“Ignore previous instructions”)\u003C/li>\n\u003Cli>Context switching attempts\u003C/li>\n\u003Cli>Delimiter injection\u003C/li>\n\u003Cli>Encoded attacks\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Security, jailbreak prevention\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"blocked-keywords\">Blocked Keywords\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#blocked-keywords\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Blocked Keywords”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Block specific terms or phrases:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { blockedKeywords } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">blockedKeywords\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">keywords: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'spam'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'scam'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'phishing'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">caseSensitive: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">false\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { blockedKeywords } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    blockedKeywords({      keywords: [&#x27;spam&#x27;, &#x27;scam&#x27;, &#x27;phishing&#x27;],      caseSensitive: false,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Content policy enforcement, brand safety\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"input-length-limit\">Input Length Limit\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#input-length-limit\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Input Length Limit”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Enforce maximum input length:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { inputLengthLimit } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">inputLengthLimit\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxLength: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">unit: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'characters'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// or 'tokens'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { inputLengthLimit } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    inputLengthLimit({      maxLength: 1000,      unit: &#x27;characters&#x27;, // or &#x27;tokens&#x27;    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Cost control, DoS prevention\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"rate-limiting\">Rate Limiting\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#rate-limiting\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Rate Limiting”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Per-user or global rate limits:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { rateLimiting } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">rateLimiting\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxRequests: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">10\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">windowMs: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">60000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 10 requests per minute\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">keyExtractor\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">: (\u003C/span>\u003Cspan style=\"--0:#FFAB70;--1:#AE4B07\">params\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> params.userId,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { rateLimiting } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    rateLimiting({      maxRequests: 10,      windowMs: 60000, // 10 requests per minute      keyExtractor: (params) => params.userId,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Abuse prevention, fair usage\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"profanity-filter\">Profanity Filter\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#profanity-filter\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Profanity Filter”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Block offensive language:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { profanityFilter } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">profanityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">severity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'medium'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 'low', 'medium', 'high'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { profanityFilter } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    profanityFilter({      severity: &#x27;medium&#x27;, // &#x27;low&#x27;, &#x27;medium&#x27;, &#x27;high&#x27;    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Content moderation, family-friendly apps\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"toxicity-detector\">Toxicity Detector\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#toxicity-detector\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Toxicity Detector”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Detect toxic or harmful content:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { toxicityDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">threshold: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0.7\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 0-1, lower = stricter\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { toxicityDetector } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    toxicityDetector({      threshold: 0.7, // 0-1, lower = stricter    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Safety, harassment prevention\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"allowed-tools-guardrail\">Allowed Tools Guardrail\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#allowed-tools-guardrail\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Allowed Tools Guardrail”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Restrict which tools can be used:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { allowedToolsGuardrail } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">allowedToolsGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">allowedTools: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'search'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'calculator'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { allowedToolsGuardrail } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    allowedToolsGuardrail({      allowedTools: [&#x27;search&#x27;, &#x27;calculator&#x27;],    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Tool security, controlled execution\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"output-guardrails\">Output Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#output-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Output Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Output guardrails run \u003Cstrong>after\u003C/strong> the AI model responds, ensuring quality and safety.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"sensitive-data-filter\">Sensitive Data Filter\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#sensitive-data-filter\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Sensitive Data Filter”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Remove secrets and API keys:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { sensitiveDataFilter } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">()],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { sensitiveDataFilter } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [sensitiveDataFilter()],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Filters:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>API keys (AWS, OpenAI, GitHub, etc.)\u003C/li>\n\u003Cli>Private keys and certificates\u003C/li>\n\u003Cli>OAuth tokens\u003C/li>\n\u003Cli>Database credentials\u003C/li>\n\u003Cli>Environment variables\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Security, preventing leaks\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"min-length-requirement\">Min Length Requirement\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#min-length-requirement\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Min Length Requirement”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Enforce minimum response length:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { minLengthRequirement } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 100 characters minimum\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { minLengthRequirement } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    minLengthRequirement(100), // 100 characters minimum  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Quality control, ensuring completeness\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"output-length-limit\">Output Length Limit\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#output-length-limit\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Output Length Limit”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Enforce maximum response length:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { outputLengthLimit } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">outputLengthLimit\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxLength: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">500\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">unit: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'characters'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// or 'tokens'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { outputLengthLimit } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    outputLengthLimit({      maxLength: 500,      unit: &#x27;characters&#x27;, // or &#x27;tokens&#x27;    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Cost control, UX constraints\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"toxicity-filter\">Toxicity Filter\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#toxicity-filter\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Toxicity Filter”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Block toxic responses:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { toxicityFilter } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">threshold: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0.7\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { toxicityFilter } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    toxicityFilter({      threshold: 0.7,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Safety, preventing harmful outputs\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"json-validation\">JSON Validation\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#json-validation\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “JSON Validation”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Validate JSON structure:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { jsonValidation } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">jsonValidation\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">strict: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// Require valid JSON\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { jsonValidation } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    jsonValidation({      strict: true, // Require valid JSON    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Structured output, API integration\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"schema-validation\">Schema Validation\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#schema-validation\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Schema Validation”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Validate against Zod schema:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { schemaValidation } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { z } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'zod'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">schemaValidation\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">schema: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">name: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">string\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">age: z.\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">number\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { schemaValidation } from &#x27;ai-sdk-guardrails&#x27;;import { z } from &#x27;zod&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    schemaValidation({      schema: z.object({        name: z.string(),        age: z.number(),      }),    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Type safety, data validation\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"confidence-threshold\">Confidence Threshold\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#confidence-threshold\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Confidence Threshold”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Require minimum confidence:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { confidenceThreshold } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">confidenceThreshold\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">minConfidence: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0.8\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { confidenceThreshold } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    confidenceThreshold({      minConfidence: 0.8,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Quality assurance, uncertain responses\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"hallucination-detector\">Hallucination Detector\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#hallucination-detector\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Hallucination Detector”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Detect uncertain or unsupported claims:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { hallucinationDetector } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">hallucinationDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">sensitivity: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'medium'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 'low', 'medium', 'high'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { hallucinationDetector } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    hallucinationDetector({      sensitivity: &#x27;medium&#x27;, // &#x27;low&#x27;, &#x27;medium&#x27;, &#x27;high&#x27;    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Accuracy, factual correctness\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"secret-redaction\">Secret Redaction\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#secret-redaction\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Secret Redaction”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Redact secrets from output:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { secretRedaction } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">secretRedaction\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">redactWith: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'[REDACTED]'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { secretRedaction } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    secretRedaction({      redactWith: &#x27;[REDACTED]&#x27;,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Security, preventing accidental leaks\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"mcp-security-guardrails\">MCP Security Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#mcp-security-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “MCP Security Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Specialized guardrails for Model Context Protocol (MCP) tools.\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"mcp-security-guardrail\">MCP Security Guardrail\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#mcp-security-guardrail\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “MCP Security Guardrail”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>MCP security:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { mcpSecurityGuardrail } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">mcpSecurityGuardrail\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">detectExfiltration: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">scanEncodedContent: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">allowedDomains: [\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'api.company.com'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">maxContentSize: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">51200\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\">// 50KB\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">injectionThreshold: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0.7\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { mcpSecurityGuardrail } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    mcpSecurityGuardrail({      detectExfiltration: true,      scanEncodedContent: true,      allowedDomains: [&#x27;api.company.com&#x27;],      maxContentSize: 51200, // 50KB      injectionThreshold: 0.7,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Prevents:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Direct prompt injection\u003C/li>\n\u003Cli>Tool response poisoning\u003C/li>\n\u003Cli>Data exfiltration via URLs\u003C/li>\n\u003Cli>Encoded attacks (base64/hex)\u003C/li>\n\u003Cli>Cascading exploits\u003C/li>\n\u003Cli>Context poisoning\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"sl-heading-wrapper level-h3\">\u003Ch3 id=\"mcp-response-sanitizer\">MCP Response Sanitizer\u003C/h3>\u003Ca class=\"sl-anchor-link\" href=\"#mcp-response-sanitizer\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “MCP Response Sanitizer”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Clean malicious content:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> { mcpResponseSanitizer } \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'ai-sdk-guardrails'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">mcpResponseSanitizer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">removeUrls: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">sanitizeJson: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">true\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">}),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import { mcpResponseSanitizer } from &#x27;ai-sdk-guardrails&#x27;;const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  outputGuardrails: [    mcpResponseSanitizer({      removeUrls: true,      sanitizeJson: true,    }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cstrong>Use cases:\u003C/strong> Non-blocking security, content cleaning\u003C/p>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"combining-guardrails\">Combining Guardrails\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#combining-guardrails\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Combining Guardrails”\u003C/span>\u003C/a>\u003C/div>\n\u003Cp>Mix and match guardrails for protection:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame not-content\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ts\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">const\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">model\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">withGuardrails\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">openai\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">'gpt-4o'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">), {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">inputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">piiDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">promptInjectionDetector\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">inputLengthLimit\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ maxLength: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">rateLimiting\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ maxRequests: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">10\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, windowMs: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">60000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">outputGuardrails: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">sensitiveDataFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">minLengthRequirement\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">100\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">toxicityFilter\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ threshold: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">0.7\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> }),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#6F42C1\">schemaValidation\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">({ schema: mySchema }),\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">});\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"const model = withGuardrails(openai(&#x27;gpt-4o&#x27;), {  inputGuardrails: [    piiDetector(),    promptInjectionDetector(),    inputLengthLimit({ maxLength: 1000 }),    rateLimiting({ maxRequests: 10, windowMs: 60000 }),  ],  outputGuardrails: [    sensitiveDataFilter(),    minLengthRequirement(100),    toxicityFilter({ threshold: 0.7 }),    schemaValidation({ schema: mySchema }),  ],});\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"sl-heading-wrapper level-h2\">\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\u003Ca class=\"sl-anchor-link\" href=\"#next-steps\">\u003Cspan aria-hidden=\"true\" class=\"sl-anchor-icon\">\u003Csvg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\u003Cpath fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"sr-only\">Section titled “Next Steps”\u003C/span>\u003C/a>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Ca href=\"/guides/custom-guardrails/\">Custom Guardrails\u003C/a> - Create your own guardrails\u003C/li>\n\u003Cli>\u003Ca href=\"/reference/api/\">API Reference\u003C/a> - Complete API documentation\u003C/li>\n\u003Cli>\u003Ca href=\"/examples/\">Examples\u003C/a> - See guardrails in action\u003C/li>\n\u003C/ul>",{"headings":455,"localImagePaths":520,"remoteImagePaths":521,"frontmatter":522,"imagePaths":523},[456,457,460,463,466,469,472,475,478,481,482,485,488,491,494,497,500,503,506,509,512,515,518,519],{"depth":59,"slug":133,"text":134},{"depth":81,"slug":458,"text":459},"pii-detector","PII Detector",{"depth":81,"slug":461,"text":462},"prompt-injection-detector","Prompt Injection Detector",{"depth":81,"slug":464,"text":465},"blocked-keywords","Blocked Keywords",{"depth":81,"slug":467,"text":468},"input-length-limit","Input Length Limit",{"depth":81,"slug":470,"text":471},"rate-limiting","Rate Limiting",{"depth":81,"slug":473,"text":474},"profanity-filter","Profanity Filter",{"depth":81,"slug":476,"text":477},"toxicity-detector","Toxicity Detector",{"depth":81,"slug":479,"text":480},"allowed-tools-guardrail","Allowed Tools Guardrail",{"depth":59,"slug":136,"text":137},{"depth":81,"slug":483,"text":484},"sensitive-data-filter","Sensitive Data Filter",{"depth":81,"slug":486,"text":487},"min-length-requirement","Min Length Requirement",{"depth":81,"slug":489,"text":490},"output-length-limit","Output Length Limit",{"depth":81,"slug":492,"text":493},"toxicity-filter","Toxicity Filter",{"depth":81,"slug":495,"text":496},"json-validation","JSON Validation",{"depth":81,"slug":498,"text":499},"schema-validation","Schema Validation",{"depth":81,"slug":501,"text":502},"confidence-threshold","Confidence Threshold",{"depth":81,"slug":504,"text":505},"hallucination-detector","Hallucination Detector",{"depth":81,"slug":507,"text":508},"secret-redaction","Secret Redaction",{"depth":59,"slug":510,"text":511},"mcp-security-guardrails","MCP Security Guardrails",{"depth":81,"slug":513,"text":514},"mcp-security-guardrail","MCP Security Guardrail",{"depth":81,"slug":516,"text":517},"mcp-response-sanitizer","MCP Response Sanitizer",{"depth":59,"slug":139,"text":140},{"depth":59,"slug":106,"text":107},[],[],{"title":444,"description":445},[],"reference/built-in-guardrails.md"]